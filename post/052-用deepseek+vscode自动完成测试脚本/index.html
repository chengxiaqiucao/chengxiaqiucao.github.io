<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="vscode中使用deepseek"><title>用deepseek+vscode自动完成测试脚本</title><link rel=canonical href=https://chengxiaqiucao.github.io/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="用deepseek+vscode自动完成测试脚本"><meta property='og:description' content="vscode中使用deepseek"><meta property='og:url' content='https://chengxiaqiucao.github.io/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/'><meta property='og:site_name' content='秋 草 观 “测” 台'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='AI测试'><meta property='article:tag' content='Playwright'><meta property='article:published_time' content='2025-01-31T21:29:12+08:00'><meta property='article:modified_time' content='2025-01-31T21:29:12+08:00'><meta name=twitter:title content="用deepseek+vscode自动完成测试脚本"><meta name=twitter:description content="vscode中使用deepseek"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/automnGrass_hu_5e44a092fd905642.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>秋 草 观 “测” 台</a></h1><h2 class=site-description>Testing is not just checking...</h2></div></header><ol class=menu-social><li><a href=https://github.com/chengxiaqiucao target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://space.bilibili.com/472272606 target=_blank title=Bilibili rel=me><!doctype html><svg t="1750732982440" class="icon" viewBox="0 0 1024 1024" p-id="4593" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632 444.330667 256h135.296l138.368-138.325333A42.666667 42.666667.0 01778.368 178.048L700.330667 256H789.333333A149.333333 149.333333.0 01938.666667 405.333333v341.333334A149.333333 149.333333.0 01789.333333 896H234.666667A149.333333 149.333333.0 0185.333333 746.666667V405.333333A149.333333 149.333333.0 01234.666667 256h88.96L245.632 177.962667a42.666667 42.666667.0 0160.373333-60.373334zm483.328 223.701333H234.666667a64 64 0 00-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0057.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0063.701334-57.856L853.333333 746.666667V405.333333a64 64 0 00-64-64zm-448 128A42.666667 42.666667.0 01384 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666666-42.666667zm341.333334.0A42.666667 42.666667.0 01725.333333 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666667-42.666667z" p-id="4594" fill="#8a8a8a"/></svg></a></li><li><a href=https://www.zhihu.com/people/qiucao target=_blank title=zhihu rel=me><!doctype html><svg t="1750733049138" class="icon" viewBox="0 0 1024 1024" p-id="5820" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M570.581333 806.272h61.952L652.928 876.117333 764.074667 806.272h130.986666V230.186667h-324.48V806.272zM636.501333 292.693333h192.64V743.68h-73.898666l-73.813334 46.378667L668.032 743.808l-31.530667-.128V292.736zM515.754667 493.738667H377.429333a2999.466667 2999.466667.0 005.802667-194.56h135.338667S523.776 239.445334 495.872 240.128H261.76c9.216-34.730667 20.821333-70.613333 34.688-107.690667.0.0-63.701333.0-85.333333 57.130667C202.112 213.12 176.128 303.786667 129.877333 396.416c15.573333-1.706667 67.114667-3.114667 97.450667-58.794667 5.589333-15.616 6.656-17.621333 13.568-38.485333h76.373333c0 27.776-3.157333 177.109333-4.437333 194.474667h-138.24c-31.104.0-41.173333 62.549333-41.173333 62.549333h173.482666C295.253333 688.256 232.789333 799.573333 119.466667 887.466667c54.186667 15.488 108.202667-2.432 134.912-26.197334.0.0 60.8-55.338667 94.122666-183.381333L491.264 849.834667s20.906667-71.168-3.285333-105.856c-20.053333-23.637333-74.24-87.552-97.322667-110.72l-38.698667 30.72c11.52-36.992 18.474667-72.96 20.821334-107.690667h163.072s-.213333-62.549333-20.053334-62.549333z" p-id="5821" fill="#8a8a8a"/></svg></a></li><li><a href=mailto:%20danmyw@qq.com target=_blank title=e-mail rel=me><!doctype html><svg t="1750733089669" class="icon" viewBox="0 0 1451 1024" p-id="6983" xmlns:xlink="http://www.w3.org/1999/xlink" width="283.3984375" height="200"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z" fill="#8a8a8a" p-id="6984"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>检索</span></a></li><li><a href=/page/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li><a href=/page/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/page/releases/><svg class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg>
<span>热门开源</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://chengxiaqiucao.github.io/en/>English</option><option value=https://chengxiaqiucao.github.io/ selected>中文</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#安装ai-toolkit并启用deepseek>安装AI ToolKit并启用Deepseek</a></li><li><a href=#ai帮助生成脚本>AI帮助生成脚本</a><ol><li><a href=#思考过程>思考过程</a><ol><li></li></ol></li><li><a href=#具体实现>具体实现</a></li><li><a href=#项目结构>项目结构</a></li><li><a href=#依赖安装>依赖安装</a></li><li><a href=#文件实现>文件实现</a><ol><li><a href=#useryml>user.yml</a></li><li><a href=#pageslogin_pagepy>pages/login_page.py</a></li><li><a href=#pagesinventory_pagepy>pages/inventory_page.py</a></li><li><a href=#pagescart_pagepy>pages/cart_page.py</a></li><li><a href=#pagescheckout_pagepy>pages/checkout_page.py</a></li><li><a href=#pagescheckout_overview_pagepy>pages/checkout_overview_page.py</a></li><li><a href=#conftestpy>conftest.py</a></li><li><a href=#test_loginpy>test_login.py</a></li><li><a href=#test_checkoutpy>test_checkout.py</a></li></ol></li><li><a href=#知识点和解释>知识点和解释</a></li><li><a href=#结论>结论</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/ style=background-color:#2a9d8f;color:#fff>测试技术</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/>用deepseek+vscode自动完成测试脚本</a></h2><h3 class=article-subtitle>vscode中使用deepseek</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jan 31, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 18 分钟</time></div></footer></div></header><section class=article-content><p>近几日Deepseek大火，我这里也尝试了一下，确实很强。而目前vscode的AI toolkit插件也已经集成了deepseek R1，这里就介绍下在vscode中利用deepseek帮助我们完成自动化测试脚本的实践分享</p><h2 id=安装ai-toolkit并启用deepseek>安装AI ToolKit并启用Deepseek</h2><p>微软官方提供了一个针对AI辅助的插件，也就是 <strong>AI Toolkit for Visual Studio Code</strong>， 这个插件可以利用各种开源或商用的大模型，目前也已经集成了Deepseek R1模型，可以让我们在VS code中方便地利用Deepseek来帮助我们的代码开发</p><p>首先在插件中心中找到<strong>AI Toolkit</strong>并完成安装</p><p><img src=/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-1.png width=1586 height=1180 srcset="/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-1_hu_21e0d5258939b6d2.png 480w, /post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-1_hu_b96bba8591f888d8.png 1024w" loading=lazy class=gallery-image data-flex-grow=134 data-flex-basis=322px></p><p>安装完成插件以后，在插件页面，选择catalog中的models模型页面，并通过筛选条件 <code>hosted by Github</code>, 以及 <code>publisher Deepseek</code> 使用Deepseek-R1模型</p><p><img src=/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131.png width=1403 height=1040 srcset="/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131_hu_75f3fee0b99aaf21.png 480w, /post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131_hu_ec9505cc538860aa.png 1024w" loading=lazy class=gallery-image data-flex-grow=134 data-flex-basis=323px></p><h2 id=ai帮助生成脚本>AI帮助生成脚本</h2><p>有了deepseek模型后，我们就可以新建一个playgroud让deepseek帮助我们生成自动化脚本了，以下是我让Deepseek生成的针对saucedemo的测试脚本</p><p><img src=/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-2.png width=1196 height=657 srcset="/post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-2_hu_de464dae80bb5d2a.png 480w, /post/052-%E7%94%A8deepseek+vscode%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC/Pasted-20250131-2_hu_2b9c36158ae3ebfc.png 1024w" loading=lazy class=gallery-image data-flex-grow=182 data-flex-basis=436px></p><h3 id=思考过程>思考过程</h3><p>嗯，我现在需要帮忙设计一个基于pytest和Playwright的自动化测试项目，针对saucedemo.com的登录和checkout流程，使用POM模式，用户数据放在user.yml里，还要包含异常场景。好的，我得一步一步来。</p><p>首先，应该确定项目的结构。POM模式的话，通常会有page对象、测试用例、配置文件、数据文件等。可能需要这样的目录结构：</p><ul><li>tests/<ul><li>pages/<ul><li>login_page.py</li><li>inventory_page.py</li><li>cart_page.py</li><li>checkout_page.py</li></ul></li><li>test_login.py</li><li>test_checkout.py</li></ul></li><li>conftest.py</li><li>user.yml</li><li>pytest.ini</li></ul><p>然后，用户数据存在user.yml里，里面应该有不同的用户类型，比如标准用户，锁定用户，错误密码，没有用户等。然后测试用例要读取这些数据。</p><p>接下来是Page Object Model的实现。每个页面比如登录页、商品页，购物车页、结算页都有自己的类，封装元素和操作。比如LoginPage有用户名、密码输入框，登录按钮，错误提示的方法。</p><p>测试用例应该使用pytest的参数化来覆盖不同的用户场景。比如正常登录成功，无效密码，锁定用户等。同时，checkout流程需要正常流程的测试，可能还有填写信息不完整的情况。</p><p>然后考虑conftest.py里面设置Playwright的fixture，比如browser，page，以及各个page对象的fixture。比如，每次测试前都转到登录页，登录后到库存页，这样可以处理前置条件。</p><p>异常场景的话，例如登录时的各种错误信息，结账时的表单验证，比如必须填first name等。需要编写这些测试用例，并验证错误提示是否正确。</p><p>用户的数据如何加载呢？可能用pyYAML库来读取user.yml文件，里面分不同用户的数据。测试时用@pytest.mark.parametrize参数化输入不同的用户数据。</p><p>比如，用户数据分成valid_users，invalid_password，locked_user等键。在测试登录的时候，参数化这些情况，触发不同的测试用例。</p><p>在测试checkout流程时，可能需要先登录，然后添加商品到购物车，进入购物车，进入结算页，填写信息，完成checkout。这时候，正常的测试用例需要用有效的数据，而异常情况比如不填写某些字段需要验证错误提示。</p><p>还需要处理元素的选择器，Playwright的定位方法，比如使用CSS选择器或文本定位。例如，登录页可能通过id定位用户名和密码输入框。</p><p>此外，测试完成后需要清理状态吗？比如，购物车中的商品或者是否需要登出，或者每个测试用例之间保持独立，可能使用 fixtures 来确保各自的状态。</p><p>也可能需要处理异步操作，不过Playwright是自动处理等待的，所以在页面导航或元素点击时不需要额外处理。</p><p>现在，具体的步骤：</p><ol><li>创建项目结构，安装依赖：pytest, playwright, pyyaml。</li><li>编写user.yml，包含不同类型的用户数据。</li><li>实现各个页面的Page类，包含元素定位和操作方法。</li><li>在conftest.py中定义fixture，例如初始化page，创建各page对象的实例。</li><li>编写测试用例，参数化用户数据，覆盖正常和异常流程。</li><li>处理测试中的等待和断言，确保元素的存在或文本正确。</li></ol><p>需要检查测试用例是否覆盖以下场景：</p><p>登录：</p><ul><li>正确用户密码登录成功。</li><li>错误密码提示错误信息。</li><li>锁定用户无法登录。</li><li>空用户名或密码提示错误。</li></ul><p>Checkout：</p><ul><li>正常填写所有信息，完成订单。</li><li>必填字段缺失（如first name为空）提示错误。</li><li>取消订单流程。</li></ul><p>现在，user.yml的结构应该是什么样的？</p><p>可能如下：</p><p>users: valid_user: username: standard_user password: secret_sauce invalid_password_user: username: standard_user password: wrongpass locked_user: username: locked_out_user password: secret_sauce missing_username: username: "" password: secret_sauce missing_password: username: standard_user password: ""</p><p>在测试登录的时候，参数化这些情况。比如，对于valid_user，应该登录成功，跳转到/inventory.html。对于invalid_password，显示Epic sadface: Username and password do not match。锁定的用户提示Epic sadface: Sorry, this user has been locked out。缺少用户名或密码提示相应的错误信息。</p><p>对于checkout流程，可行的步骤是：</p><p>登录后，添加一个商品到购物车，点击购物车图标，进入购物车页，点击checkout按钮，填写信息，继续，完成。</p><p>所以测试用例需要参数化填写的信息是否正确。例如：</p><p>正常情况下的信息：</p><p>first_name: John last_name: Doe zip: 12345</p><p>异常情况，比如不填first name，是否提示错误。</p><p>在编写这些测试时，需要使用页面对象的方法来完成每个步骤，比如添加商品，进入购物车，填写信息，继续按钮等。</p><p>可能的问题点：</p><p>元素的定位是否正确，特别是动态生成的内容或者异步加载的部分是否需要等待。不过Playwright有自动等待机制，所以选择元素时只要正确选择应该没问题。</p><p>需要断言的地方包括：登录后的页面URL是否正确，订单完成后的确认信息是否存在，错误提示是否显示正确的文本。</p><p>比如，登录成功后应该跳转到/inventory.html；checkout完成后应该显示“Thank you for your order”。</p><p>另外，可能需要清理购物车，但因为每个测试可能独立运行，或者每个测试都重新开始会话，所以在fixture中可以处理，如在每次测试前登录并重置状态？</p><p>或者使用类似于beforeEach的fixture，让每个测试用例开始时处于某个状态。比如，登录后的页面。</p><p>此外，测试购物流程需要添加商品到购物车，所以库存页面的类需要有添加商品的方法。</p><p>Page类示例：</p><p>InventoryPage可以有添加某个商品的方法，比如点击“Add to cart”按钮。比如，根据商品名称定位对应的按钮。不过这可能比较复杂，也许在页面上使用通用的方法。</p><p>或者，在InventoryPage中有方法add_item_to_cart(item_name)，用于点击对应商品的添加按钮。这时需要使用Playwright的定位方法，例如：</p><p>def add_item_to_cart(self, item_name): self.page.locator(f"text={item_name}").locator(&ldquo;xpath=..&rdquo;).locator(&ldquo;button&rdquo;).click()</p><p>不过这可能需要根据实际的DOM结构来确定。可能需要inspector查看元素结构。</p><p>例如，每个商品项的结构可能类似：</p><div class=inventory_item><div class=inventory_item_name>Sauce Labs Backpack</div><button class="btn btn_primary">Add to cart</button></div><p>所以，找到对应的名称元素，然后找到其父级元素中的按钮。</p><p>或者，更简单的办法是每个商品的“Add to cart”按钮有不同的id，比如 add-to-cart-sauce-labs-backpack，或其他属性。需要看实际网站的结构。</p><p>登录后的页面可能有多个商品，每个商品对应的添加按钮可能需要通过其文本来定位对应的按钮。或者通过其他属性。</p><p>现在，需要实际查看saucedemo.com的结构。可能使用Playwright的代码生成功能来获取正确的选择器。</p><p>假设，例如，每个商品的“Add to cart”按钮的id是动态生成的或者类似，例如对于“Sauce Labs Backpack”，对应的按钮的id可能是add-to-cart-sauce-labs-backpack，那么可以直接通过这个id去定位。</p><p>这样的话，InventoryPage中可以有一个方法：</p><p>def add_product_to_cart(self, product_name): product_id = product_name.lower().replace(&rsquo; &lsquo;, &lsquo;-&rsquo;) self.page.click(f"#add-to-cart-{product_id}")</p><p>当然，这需要查看实际的网站结构是否正确。</p><p>假设正确的商品example在这里是Sauce Labs Backpack，其id可能确实是这样的，这样方法可行。</p><p>另外，购物车图标上的数量是否正确，当商品添加后，购物车的图标显示数量为1。当进入购物车页，是否有对应的商品。</p><p>需要注意，每个操作之后的页面变化是否需要新的Page对象实例，比如在InventoryPage点击购物车后跳转到CartPage，所以该操作应该返回CartPage的实例，从而能够继续操作。</p><p>这样方法的返回值处理可能成为问题。比如：</p><p>在InventoryPage中的方法：</p><p>def go_to_cart(self): self.page.click(".shopping_cart_link") return CartPage(self.page)</p><p>类似这样，每个导航动作返回新的Page对象。</p><p>这会需要在各个页面的方法中处理返回相应的页面对象。</p><p>然后是测试流程的组装：</p><p>在测试checkout的时候，可能步骤很多，需要写一个大的测试用例，分步骤进行：</p><p>例如：</p><p>def test_checkout_process(login_page, inventory_page, checkout_data): # 登录 login_page.login(&ldquo;standard_user&rdquo;, &ldquo;secret_sauce&rdquo;) # 添加商品 inventory_page.add_product_to_cart(&ldquo;Sauce Labs Backpack&rdquo;) inventory_page.go_to_cart() # 进入购物车页面，点击checkout cart_page.click_checkout() # 填写checkout信息 checkout_page.fill_shipping_info(checkout_data) checkout_page.continue_to_overview() # 确认订单 checkout_page.finish_checkout() # 断言是否成功 assert checkout_page.get_order_confirmation() == &ldquo;Thank you for your order!&rdquo;</p><p>当然，这可能涉及到许多页面的跳转，每个页面之间需要用对应的方法来连接。</p><p>异常场景的话，比如在填写信息的时候不输入first name，点击continue时，出现错误提示。</p><p>此时，测试用例可能参数化不同的数据，比如：</p><p>@pytest.mark.parametrize(&ldquo;first_name, last_name, zip_code, error_message&rdquo;, [ ("", &ldquo;Doe&rdquo;, &ldquo;12345&rdquo;, &ldquo;Error: First Name is required&rdquo;), (&ldquo;John&rdquo;, &ldquo;&rdquo;, &ldquo;12345&rdquo;, &ldquo;Error: Last Name is required&rdquo;), (&ldquo;John&rdquo;, &ldquo;Doe&rdquo;, &ldquo;&rdquo;, &ldquo;Error: Postal Code is required&rdquo;), ]) def test_checkout_missing_fields(&mldr;, first_name, last_name, zip_code, error_message): # 填信息时，漏掉对应字段 checkout_page.fill_shipping_info(first_name, last_name, zip_code) checkout_page.continue_to_overview() assert checkout_page.get_error_message() == error_message</p><p>可能还需要考虑，错误信息提示元素的定位是否正确，以及当出现错误时是否阻止进入下一步。</p><p>现在，问题可能是如何组织这些数据和页面方法。</p><p>另外，关于用户数据的读取，测试用例需要从YAML文件中加载。可能的做法是在conftest.py里面写个fixture读取YAML的数据，然后参数化测试用例。</p><p>但pytest的参数化可能需要特定的方式处理，可能将YAML数据转换成测试参数。或者使用外部数据源来参数化测试。</p><p>例如，在conftest.py中读取user.yml的所有用户数据，并为登录测试创建一个参数化的fixture。</p><p>或者，可以在测试用例中直接读取YAML文件中的数据，并将其参数化。</p><p>比如：</p><p>import yaml</p><p>def load_users(): with open(&lsquo;user.yml&rsquo;) as f: data = yaml.safe_load(f) return data[&lsquo;users&rsquo;]</p><p>然后在测试用例中用：</p><p>@pytest.mark.parametrize(&ldquo;user&rdquo;, [ (&ldquo;valid_user&rdquo;), (&ldquo;invalid_password_user&rdquo;), (&ldquo;locked_user&rdquo;), # &mldr; 其他情况 ], indirect=True) def test_login(login_page, user): login_page.login(user[&lsquo;username&rsquo;], user[&lsquo;password&rsquo;]) # 断言等操作</p><p>不过，如何将数据转换为参数可能需要更细致的处理，比如将各个用户数据提取成各个测试实例的参数。</p><p>可能更好的方法是将不同的用户情况分别写成不同的测试数据项。例如，把不同用户类型数据的键列出来，然后根据这些键从数据中加载相应的参数。</p><p>或者，在所有参数化时，导入所有用户数据作为参数。</p><p>比如：</p><p>import yaml import pytest</p><p>with open(&lsquo;user.yml&rsquo;) as f: user_data = yaml.safe_load(f)[&lsquo;users&rsquo;]</p><p>login_test_data = [ (user_data[&lsquo;valid_user&rsquo;], True, None), # 正常用户，登录成功，没有错误 (user_data[&lsquo;invalid_password_user&rsquo;], False, &lsquo;Epic sadface: Username and password do not match&rsquo;), (user_data[&rsquo;locked_user&rsquo;], False, &lsquo;Epic sadface: Sorry, this user has been locked out.&rsquo;), # &mldr; 其他情况 ]</p><p>@pytest.mark.parametrize(&ldquo;user, success, error_msg&rdquo;, login_test_data) def test_login_user(login_page, user, success, error_msg): login_page.navigate() login_page.login(user[&lsquo;username&rsquo;], user[&lsquo;password&rsquo;]) if success: assert login_page.current_url == &lsquo;<a class=link href=https://www.saucedemo.com/inventory.html%27 target=_blank rel=noopener>https://www.saucedemo.com/inventory.html'</a> else: assert login_page.get_error_message() == error_msg</p><p>这时候，需要在user.yml里的每个用户数据中有一个error键，或者在参数化的准备阶段处理错误信息的映射。</p><p>不过这样的参数方式可能更灵活，能够同时指定预期结果。</p><p>对于YAML的结构，可能需要更详细的数据项，每个用户数据包含预期的错误消息。</p><p>例如，user.yml部分内容：</p><p>valid_user: username: standard_user password: secret_sauce expected: success: true error: null</p><p>invalid_password_user: username: standard_user password: wrong expected: success: false error: &ldquo;Epic sadface: Username and password do not match&rdquo;</p><p>locked_user: username: locked_out_user password: secret_sauce expected: success: false error: &ldquo;Epic sadface: Sorry, this user has been locked out.&rdquo;</p><p>这样参数化时可以更具结构化。但在编写YAML时需要考虑每个用例的期望结果。</p><p>这样，测试用例的参数可能会是直接从YAML中读取的结构，然后通过解析不同的用户组生成测试用例参数。</p><p>不过，这可能有些复杂。另一个办法是，将每个测试案例定义为YAML中的一个项目，包含输入数据和预期结果。</p><p>总之，这部分的处理可能需要更多设计。</p><p>然后，关于Playwright的fixture设置，在conftest.py里可以使用pytest-playwright提供的fixture。例如，使用pytest-playwright插件中的page fixture。不过这可能需要安装pytest-playwright库，并调用playwright的安装步骤。</p><p>安装依赖包括：</p><p>pytest-playwright playwright pyyaml</p><p>执行playwright install安装浏览器。</p><p>然后，在conftest.py中，定义如何初始化各个page对象，并将它们作为fixture注入到测试用例中。</p><p>例如：</p><p>import pytest from playwright.sync_api import Page from pages.login_page import LoginPage from pages.inventory_page import InventoryPage</p><h5 id=其他页面的导入>其他页面的导入</h5><p>@pytest.fixture def login_page(page: Page): return LoginPage(page)</p><p>@pytest.fixture def inventory_page(page: Page): return InventoryPage(page)</p><p>等等。这样每个测试用例如果需要用到特定的页面对象，可以直接在参数中声明需要的fixture。</p><p>例如，一个测试用例函数可能接收login_page和inventory_page作为参数。</p><p>接下来，各个Page类的示例。</p><p>LoginPage类是这样的：</p><p>class LoginPage: def <strong>init</strong>(self, page): self.page = page self.username_input = page.locator("#user-name") self.password_input = page.locator("#password") self.login_button = page.locator("#login-button") self.error_message = page.locator(".error-message-container")</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>def navigate(self):
</span></span><span class=line><span class=cl>    self.page.goto(&#34;https://www.saucedemo.com&#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def login(self, username, password):
</span></span><span class=line><span class=cl>    self.username_input.fill(username)
</span></span><span class=line><span class=cl>    self.password_input.fill(password)
</span></span><span class=line><span class=cl>    self.login_button.click()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def get_error_message(self):
</span></span><span class=line><span class=cl>    return self.error_message.inner_text()
</span></span></code></pre></td></tr></table></div></div><p>但实际情况需要根据saucedemo.com的实际HTML结构调整选择器。比如，错误信息的元素可能是div.error-message-container带有data-test=&ldquo;error"的属性，其文本可能在某个子元素内。</p><p>比如说，实际的网站中，错误信息的HTML可能是：</p><div class=error-message-container data-test=error><h3>Epic sadface: Username and password do not match any user in this service</h3><button class=error-button data-test=关闭错误信息></button></div><p>那么，error_message的locator需要定位到h3元素的文本。或者，定位到整个容器，然后用inner_text()获取文本。</p><p>或者，正确的选择器可能是：</p><p>error_message = page.locator(&rsquo;[data-test=&ldquo;error&rdquo;]&rsquo;)</p><p>但Playwright支持多种选择方式，比如用data-testid属性等，所以在编写时需要查证正确的元素定位方式。</p><p>所以可能更好的方式是使用data-test属性来选择元素，例如登录页的数据测试属性：</p><p>用户名输入：data-test=&ldquo;username&rdquo;</p><p>密码输入：data-test=&ldquo;password&rdquo;</p><p>登录按钮：data-test=&ldquo;login-button&rdquo;</p><p>错误信息元素：data-test=&ldquo;error&rdquo;，所以其元素可以定位为：</p><p>self.error_message = page.locator(&rsquo;[data-test=&ldquo;error&rdquo;]&rsquo;)</p><p>然后其文本内容可以用error_message.inner_text()来获取，包含错误信息的关键部分。</p><p>至于其他页面，比如库存页面，购物车页等：</p><p>InventoryPage可能有添加商品到购物车的方法，跳转到购物车的方法，或许购物车数量的显示。例如：</p><p>class InventoryPage: def <strong>init</strong>(self, page: Page): self.page = page</p><p>def add_product_to_cart(self, product_name):
# 这里假设商品名称对应的添加按钮如何定位，假设data-test属性中有对应的add-to-cart按钮，例如 data-test=&ldquo;add-to-cart-sauce-labs-backpack&rdquo;
product_id = product_name.lower().replace(&rsquo; &lsquo;, &lsquo;-&rsquo;)
self.page.locator(f&rsquo;[data-test=&ldquo;add-to-cart-{product_id}&rdquo;]&rsquo;).click()</p><p>def get_cart_count(self):
return self.page.locator(&rsquo;.shopping_cart_badge&rsquo;).inner_text()</p><p>def go_to_cart(self):
self.page.locator(&rsquo;.shopping_cart_link&rsquo;).click()
return CartPage(self.page)</p><p>CartPage类，可能有checkout按钮：</p><p>class CartPage: def <strong>init</strong>(self, page: Page): self.page = page</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>def checkout(self):
</span></span><span class=line><span class=cl>    self.page.locator(&#39;[data-test=&#34;checkout&#34;]&#39;).click()
</span></span><span class=line><span class=cl>    return CheckoutPage(self.page)
</span></span></code></pre></td></tr></table></div></div><p>CheckoutPage类：</p><p>class CheckoutPage: def <strong>init</strong>(self, page: Page): self.page = page self.first_name_input = page.locator(&rsquo;[data-test=&ldquo;firstName&rdquo;]&rsquo;) self.last_name_input = page.locator(&rsquo;[data-test=&ldquo;lastName&rdquo;]&rsquo;) self.postal_code_input = page.locator(&rsquo;[data-test=&ldquo;postalCode&rdquo;]&rsquo;) self.continue_button = page.locator(&rsquo;[data-test=&ldquo;continue&rdquo;]&rsquo;) self.error_message = page.locator(&rsquo;[data-test=&ldquo;error&rdquo;]&rsquo;)</p><p>def fill_shipping_info(self, first_name, last_name, postal_code):
self.first_name_input.fill(first_name)
self.last_name_input.fill(last_name)
self.postal_code_input.fill(postal_code)</p><p>def continue_to_overview(self):
self.continue_button.click()</p><p>def get_error_message(self):
return self.error_message.inner_text().strip()</p><p>然后，在完成信息填写后的页面，可能有finish按钮，在CheckoutOverviewPage类中：</p><p>class CheckoutOverviewPage: def <strong>init</strong>(self, page: Page): self.page = page self.finish_button = page.locator(&rsquo;[data-test=&ldquo;finish&rdquo;]&rsquo;) self.confirmation_message = page.locator(&rsquo;.complete-header&rsquo;)</p><p>def finish_checkout(self):
self.finish_button.click()</p><p>def get_confirmation_message(self):
return self.confirmation_message.inner_text()</p><p>当然，这些需要根据实际页面的结构进行调整，比如确认信息的元素是否正确。</p><p>这样，整体测试流程就可以通过各个页面的方法来串联。</p><p>现在编写测试用例的步骤：</p><p>测试登录流程：</p><p>参数化不同的用户数据，判断登录是否成功，或者是否出现正确的错误提示。</p><p>例如：</p><p>在test_login.py中：</p><p>import pytest from playwright.sync_api import Page</p><p>@pytest.mark.parametrize(&ldquo;user_key, expected_success, expected_error&rdquo;, [ (&ldquo;valid_user&rdquo;, True, None), (&ldquo;invalid_password_user&rdquo;, False, &ldquo;Epic sadface: Username and password do not match&rdquo;), (&ldquo;locked_user&rdquo;, False, &ldquo;Epic sadface: Sorry, this user has been locked out.&rdquo;), (&ldquo;missing_username&rdquo;, False, &ldquo;Epic sadface: Username is required&rdquo;), (&ldquo;missing_password&rdquo;, False, &ldquo;Epic sadface: Password is required&rdquo;), ]) def test_login(login_page, user_key, expected_success, expected_error): # 从YAML加载用户数据，这里假设有一个fixture可以加载全部的测试用户数据 users = load_users() user = users[user_key] login_page.navigate() login_page.login(user[&lsquo;username&rsquo;], user[&lsquo;password&rsquo;])</p><p>if expected_success:
assert login_page.page.url == &ldquo;<a class=link href=https://www.saucedemo.com/inventory.html%22 target=_blank rel=noopener>https://www.saucedemo.com/inventory.html"</a>
else:
assert login_page.get_error_message() == expected_error</p><p>需要写出load_users函数，或者使用fixture来传递给测试用例。</p><p>这里的load_users可能是在conftest.py中的一个fixture：</p><p>import pytest import yaml</p><p>@pytest.fixture def users(): with open(&lsquo;user.yml&rsquo;) as f: data = yaml.safe_load(f) return data[&lsquo;users&rsquo;]</p><p>然后测试用例可以接收users作为一个fixture：</p><p>def test_login(login_page, users, user_key, expected_success, &mldr;): user = users[user_key] &mldr;</p><p>但这种参数化可能需要结合indirect参数的使用，或者在参数化时动态获取用户数据。</p><p>或者，将参数化的数据和用户密钥对应起来，通过字典获取正确的用户数据。</p><p>这可能需要对pytest的参数化更深入的处理，例如使用间接参数化，将用户键作为参数，然后在测试函数内部获取相应用户的数据。</p><p>或者，这种参数传递方式可能不太直接，可能需要重新设计参数化的结构。</p><p>可能最好的方式在参数化的列表中直接指定用户数据的键，然后在测试用例中使用该键来索引users fixture中的对应数据。</p><p>例如：</p><p>@pytest.mark.parametrize(&ldquo;user_key, expected_success, expected_error&rdquo;, [ (&ldquo;valid_user&rdquo;, True, None), (&ldquo;invalid_password_user&rdquo;, False, &ldquo;Epic sadface: Username and password do not match&rdquo;), (&ldquo;locked_user&rdquo;, False, &ldquo;Epic sadface: Sorry, this user has been locked out.&rdquo;), (&ldquo;missing_username&rdquo;, False, &ldquo;Epic sadface: Username is required&rdquo;), (&ldquo;missing_password&rdquo;, False, &ldquo;Epic sadface: Password is required&rdquo;), ]) def test_login(login_page, users, user_key, expected_success, expected_error): user = users[user_key] login_page.navigate() login_page.login(user[&lsquo;username&rsquo;], user[&lsquo;password&rsquo;]) if expected_success: assert login_page.page.url == &ldquo;<a class=link href=https://www.saucedemo.com/inventory.html%22 target=_blank rel=noopener>https://www.saucedemo.com/inventory.html"</a> else: assert login_page.get_error_message() == expected_error</p><p>需要确保user.yml中存在相应的键，且各用户的数据正确。</p><p>对于checkout流程的正常测试：</p><p>在test_checkout.py中：</p><p>def test_successful_checkout(login_page, inventory_page, users): valid_user = users[&lsquo;valid_user&rsquo;] login_page.login(valid_user[&lsquo;username&rsquo;], valid_user[&lsquo;password&rsquo;]) inventory_page.add_product_to_cart(&ldquo;Sauce Labs Backpack&rdquo;) cart_page = inventory_page.go_to_cart() checkout_page = cart_page.checkout() checkout_page.fill_shipping_info(&ldquo;John&rdquo;, &ldquo;Doe&rdquo;, &ldquo;12345&rdquo;) checkout_page.continue_to_overview() overview_page = CheckoutOverviewPage(checkout_page.page) overview_page.finish_checkout() assert overview_page.get_confirmation_message() == &ldquo;Thank you for your order!&rdquo;</p><p>这需要定义CheckoutOverviewPage类的相应元素和方法。</p><p>对于异常测试：</p><p>比如，填写信息时省略必填字段：</p><p>@pytest.mark.parametrize(&ldquo;first_name, last_name, zip_code, expected_error&rdquo;, [ (&rdquo;&rdquo;, &ldquo;Doe&rdquo;, &ldquo;12345&rdquo;, &ldquo;Error: First Name is required&rdquo;), (&ldquo;John&rdquo;, &ldquo;&rdquo;, &ldquo;12345&rdquo;, &ldquo;Error: Last Name is required&rdquo;), (&ldquo;John&rdquo;, &ldquo;Doe&rdquo;, &ldquo;&rdquo;, &ldquo;Error: Postal Code is required&rdquo;), ]) def test_checkout_error_messages(login_page, inventory_page, users, first_name, last_name, zip_code, expected_error): valid_user = users[&lsquo;valid_user&rsquo;] login_page.login(valid_user[&lsquo;username&rsquo;], valid_user[&lsquo;password&rsquo;]) inventory_page.add_product_to_cart(&ldquo;Sauce Labs Backpack&rdquo;) cart_page = inventory_page.go_to_cart() checkout_page = cart_page.checkout() checkout_page.fill_shipping_info(first_name, last_name, zip_code) checkout_page.continue_to_overview() assert checkout_page.get_error_message() == expected_error</p><p>这里，需要确定实际的错误提示是否是类似这样的文本。比如，在reqreal的网站上，不填first name并继续时，错误提示是否真的是“Error: First Name is required”。需要查看实际页面的情况，可能错误信息是否包含在data-test=&ldquo;error"元素中，或者是否是其他结构。</p><p>综上所述，整个项目需要：</p><ul><li>正确配置POM的各个页面类。</li><li>正确读取用户数据并参数化测试用例。</li><li>处理不同测试场景的流程，尤其是Test checkout的流程可能需要连续的页面导航和状态维护。</li><li>对异常情况进行断言，如错误消息的正确性。</li></ul><p>可能还需要对页面元素的同步进行确认，尽管Playwright自动等待，但例如，点击按钮后的跳转是否完成可能会需要确认页面的某些元素，这样更稳定。</p><p>对于一些异步动作，比如点击按钮后元素变化，可以不用等待，因为Playwright内部已经处理了。</p><p>总的来说，这样的设计应该能够覆盖所需的自动化测试需求。接下来，我需要根据这些思路编写具体的代码文件，并验证是否正确工作。</p><h3 id=具体实现>具体实现</h3><p>为了基于pytest和Playwright完成针对saucedemo.com的自动化测试登录和checkout流程，并遵循POM模式，以下是详细的实现方案：</p><h3 id=项目结构>项目结构</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>project-root/
</span></span><span class=line><span class=cl>├── tests/
</span></span><span class=line><span class=cl>│   ├── pages/
</span></span><span class=line><span class=cl>│   │   ├── login_page.py
</span></span><span class=line><span class=cl>│   │   ├── inventory_page.py
</span></span><span class=line><span class=cl>│   │   ├── cart_page.py
</span></span><span class=line><span class=cl>│   │   ├── checkout_page.py
</span></span><span class=line><span class=cl>│   │   └── checkout_overview_page.py
</span></span><span class=line><span class=cl>│   ├── test_login.py
</span></span><span class=line><span class=cl>│   └── test_checkout.py
</span></span><span class=line><span class=cl>├── conftest.py
</span></span><span class=line><span class=cl>├── user.yml
</span></span><span class=line><span class=cl>└── pytest.ini
</span></span></code></pre></td></tr></table></div></div><h3 id=依赖安装>依赖安装</h3><ol><li>安装所需库：</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install pytest playwright pyyaml pytest-playwright
</span></span><span class=line><span class=cl>playwright install
</span></span></code></pre></td></tr></table></div></div><h3 id=文件实现>文件实现</h3><h4 id=useryml>user.yml</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>users</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>valid_user</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>standard_user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>secret_sauce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>invalid_password_user</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>standard_user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>wrong_pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>locked_user</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>locked_out_user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>secret_sauce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>missing_username</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>secret_sauce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>missing_password</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>standard_user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=pageslogin_pagepy>pages/login_page.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>LoginPage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span> <span class=o>=</span> <span class=n>page</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>username_input</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;username&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>password_input</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;password&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>login_button</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;login-button&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>error_message</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;error&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>navigate</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;导航到登录页&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>goto</span><span class=p>(</span><span class=s2>&#34;https://www.saucedemo.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>login</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;填充并提交登录表单&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>username_input</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>password_input</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>login_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_error_message</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;获取错误提示文本&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>error_message</span><span class=o>.</span><span class=n>inner_text</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=pagesinventory_pagepy>pages/inventory_page.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>InventoryPage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span> <span class=o>=</span> <span class=n>page</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_product_to_cart</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;将指定商品添加到购物车&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>product_id</span> <span class=o>=</span> <span class=n>product_name</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=s1>&#39;-&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[data-test=&#34;add-to-cart-</span><span class=si>{</span><span class=n>product_id</span><span class=si>}</span><span class=s1>&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>go_to_cart</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;进入购物车页面&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;.shopping_cart_link&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CartPage</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=pagescart_pagepy>pages/cart_page.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CartPage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span> <span class=o>=</span> <span class=n>page</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>checkout</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;进入结算页面&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;checkout&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CheckoutPage</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>page</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=pagescheckout_pagepy>pages/checkout_page.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CheckoutPage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span> <span class=o>=</span> <span class=n>page</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>first_name_input</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;firstName&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>last_name_input</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;lastName&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>postal_code_input</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;postalCode&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>continue_button</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;continue&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>error_message</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;error&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>fill_shipping_info</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>first_name</span><span class=p>,</span> <span class=n>last_name</span><span class=p>,</span> <span class=n>postal_code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;填写配送信息&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>first_name_input</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>first_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>last_name_input</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>last_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>postal_code_input</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>postal_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>continue_to_overview</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;提交并进入订单概览&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>continue_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_error_message</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;获取错误提示文本&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>error_message</span><span class=o>.</span><span class=n>inner_text</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=pagescheckout_overview_pagepy>pages/checkout_overview_page.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CheckoutOverviewPage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>page</span> <span class=o>=</span> <span class=n>page</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>finish_button</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;finish&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>confirmation_message</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>locator</span><span class=p>(</span><span class=s1>&#39;.complete-header&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>finish_checkout</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;完成订单&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>finish_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_confirmation_message</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;获取订单完成确认信息&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>confirmation_message</span><span class=o>.</span><span class=n>inner_text</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=conftestpy>conftest.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytest</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>yaml</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>playwright.sync_api</span> <span class=kn>import</span> <span class=n>Page</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tests.pages.login_page</span> <span class=kn>import</span> <span class=n>LoginPage</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tests.pages.inventory_page</span> <span class=kn>import</span> <span class=n>InventoryPage</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tests.pages.cart_page</span> <span class=kn>import</span> <span class=n>CartPage</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tests.pages.checkout_page</span> <span class=kn>import</span> <span class=n>CheckoutPage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.fixture</span><span class=p>(</span><span class=n>scope</span><span class=o>=</span><span class=s2>&#34;session&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>users</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;user.yml&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>yaml</span><span class=o>.</span><span class=n>safe_load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;users&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.fixture</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login_page</span><span class=p>(</span><span class=n>page</span><span class=p>:</span> <span class=n>Page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>login_page</span> <span class=o>=</span> <span class=n>LoginPage</span><span class=p>(</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>login_page</span><span class=o>.</span><span class=n>navigate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>login_page</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.fixture</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inventory_page</span><span class=p>(</span><span class=n>login_page</span><span class=p>:</span> <span class=n>LoginPage</span><span class=p>,</span> <span class=n>users</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>login_page</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=n>users</span><span class=p>[</span><span class=s1>&#39;valid_user&#39;</span><span class=p>][</span><span class=s1>&#39;username&#39;</span><span class=p>],</span> <span class=n>users</span><span class=p>[</span><span class=s1>&#39;valid_user&#39;</span><span class=p>][</span><span class=s1>&#39;password&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>InventoryPage</span><span class=p>(</span><span class=n>login_page</span><span class=o>.</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.fixture</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cart_page</span><span class=p>(</span><span class=n>inventory_page</span><span class=p>:</span> <span class=n>InventoryPage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>inventory_page</span><span class=o>.</span><span class=n>go_to_cart</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.fixture</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>checkout_page</span><span class=p>(</span><span class=n>cart_page</span><span class=p>:</span> <span class=n>CartPage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>cart_page</span><span class=o>.</span><span class=n>checkout</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=test_loginpy>test_login.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.mark.parametrize</span><span class=p>(</span><span class=s2>&#34;user_key, expected_success, expected_error&#34;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;valid_user&#34;</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>None</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;invalid_password_user&#34;</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Epic sadface: Username and password do not match&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;locked_user&#34;</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Epic sadface: Sorry, this user has been locked out.&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;missing_username&#34;</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Epic sadface: Username is required&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;missing_password&#34;</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Epic sadface: Password is required&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test_login</span><span class=p>(</span><span class=n>login_page</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>user_key</span><span class=p>,</span> <span class=n>expected_success</span><span class=p>,</span> <span class=n>expected_error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>users</span><span class=p>[</span><span class=n>user_key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>login_page</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>],</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>expected_success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>login_page</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>url</span> <span class=o>==</span> <span class=s2>&#34;https://www.saucedemo.com/inventory.html&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>login_page</span><span class=o>.</span><span class=n>get_error_message</span><span class=p>()</span> <span class=o>==</span> <span class=n>expected_error</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=test_checkoutpy>test_checkout.py</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test_successful_checkout</span><span class=p>(</span><span class=n>inventory_page</span><span class=p>,</span> <span class=n>checkout_page</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>inventory_page</span><span class=o>.</span><span class=n>add_product_to_cart</span><span class=p>(</span><span class=s2>&#34;sauce-labs-backpack&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>checkout_page</span><span class=o>.</span><span class=n>fill_shipping_info</span><span class=p>(</span><span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=s2>&#34;Doe&#34;</span><span class=p>,</span> <span class=s2>&#34;12345&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>checkout_page</span><span class=o>.</span><span class=n>continue_to_overview</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>overview_page</span> <span class=o>=</span> <span class=n>CheckoutOverviewPage</span><span class=p>(</span><span class=n>checkout_page</span><span class=o>.</span><span class=n>page</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>overview_page</span><span class=o>.</span><span class=n>finish_checkout</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=n>overview_page</span><span class=o>.</span><span class=n>get_confirmation_message</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;Thank you for your order!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@pytest.mark.parametrize</span><span class=p>(</span><span class=s2>&#34;first_name, last_name, postal_code, expected_error&#34;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;Doe&#34;</span><span class=p>,</span> <span class=s2>&#34;12345&#34;</span><span class=p>,</span> <span class=s2>&#34;Error: First Name is required&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;12345&#34;</span><span class=p>,</span> <span class=s2>&#34;Error: Last Name is required&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=s2>&#34;Doe&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=s2>&#34;Error: Postal Code is required&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>test_checkout_errors</span><span class=p>(</span><span class=n>checkout_page</span><span class=p>,</span> <span class=n>first_name</span><span class=p>,</span> <span class=n>last_name</span><span class=p>,</span> <span class=n>postal_code</span><span class=p>,</span> <span class=n>expected_error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>checkout_page</span><span class=o>.</span><span class=n>fill_shipping_info</span><span class=p>(</span><span class=n>first_name</span><span class=p>,</span> <span class=n>last_name</span><span class=p>,</span> <span class=n>postal_code</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>checkout_page</span><span class=o>.</span><span class=n>continue_to_overview</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=n>checkout_page</span><span class=o>.</span><span class=n>get_error_message</span><span class=p>()</span> <span class=o>==</span> <span class=n>expected_error</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=知识点和解释>知识点和解释</h3><ol><li><p><strong>POM设计模式</strong>:</p><ul><li>每个页面（如登录页、商品页）被封装为一个类，页面元素和操作抽象为方法，从而提高代码复用性和可维护性。</li></ul></li><li><p><strong>数据驱动测试</strong>:</p><ul><li>用户数据与测试代码分离，存储在YAML文件中，提升了可维护性，方便添加新的测试场景。</li></ul></li><li><p><strong>异常场景覆盖</strong>:</p><ul><li>通过参数化测试验证不同错误输入（如锁定用户、错误密码、缺失必填字段）是否会触发正确的错误提示。</li></ul></li><li><p><strong>Fixture管理</strong>:</p><ul><li>利用pytest的fixture管理浏览器和页面对象，确保每个测试用例的独立性，减少重复代码。</li></ul></li><li><p><strong>Playwright自动等待机制</strong>:</p><ul><li>Playwright内置的自动等待确保在操作元素前其已处于可交互状态，增强了测试的稳定性。</li></ul></li></ol><p>此方案覆盖了正常和异常的业务流程，确保核心功能点（登录、购物车、结算）的自动化验证，提高了软件质量。</p><h3 id=结论>结论</h3><p>参照给出的结果，基本不用做什么微调就可以执行成功，确实极大提升了我们进行自动化实现的效率。最难能可贵的是，deepseek给出的思考过程，对于我们代码实现和用例设计的要点也有极大的参考价值！</p></section><footer class=article-footer><section class=article-tags><a href=/tags/ai%E6%B5%8B%E8%AF%95/>AI测试</a>
<a href=/tags/playwright/>Playwright</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/083-ai%E6%B5%8B%E8%AF%95%E8%B7%AF%E7%BA%BF%E5%9B%BE/><div class=article-details><h2 class=article-title>AI测试，测试团队的必由之路</h2></div></a></article><article class=has-image><a href=/post/072-%E5%BE%AE%E8%BD%AF%E5%B7%B2%E5%8F%91%E5%B8%83playwright-mcp/><div class=article-image><img src=/post/072-%E5%BE%AE%E8%BD%AF%E5%B7%B2%E5%8F%91%E5%B8%83playwright-mcp/Pasted-20250402.edb9525a16cda48c1d70d1a55f9e35ca_hu_e06fb7fef1ae29f3.png width=250 height=150 loading=lazy alt="Featured image of post 微软已发布Playwright Mcp" data-hash="md5-7blSWhbNpIwdcNGlX541yg=="></div><div class=article-details><h2 class=article-title>微软已发布Playwright Mcp</h2></div></a></article><article><a href=/post/073-ai%E4%B8%8B%E4%B8%80%E7%AB%99-mcpserver/><div class=article-details><h2 class=article-title>AI下一站 MCPServer</h2></div></a></article><article><a href=/post/070-ai%E6%97%B6%E4%BB%A3%E7%9A%84%E6%B5%8B%E8%AF%95/><div class=article-details><h2 class=article-title>AI时代的软件测试，助手还是对手？</h2></div></a></article><article class=has-image><a href=/post/101-testmybookshelf/><div class=article-image><img src=/post/101-testmybookshelf/snap_20250611.587c273dec8eb9a41c3169765e22b5a4_hu_77aaf477deac86f2.png width=250 height=150 loading=lazy alt="Featured image of post 开源一个测试练习项目，邀请大家共建" data-hash="md5-WHwnPeyOuaQcMWl2XiK1pA=="></div><div class=article-details><h2 class=article-title>开源一个测试练习项目，邀请大家共建</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 |by 城下秋草（公众号： 秋草说测试）</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>
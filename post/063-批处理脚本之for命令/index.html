<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="For命令是批处理脚本中提效的利器！"><title>批处理脚本之For命令</title><link rel=canonical href=https://chengxiaqiucao.github.io/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="批处理脚本之For命令"><meta property='og:description' content="For命令是批处理脚本中提效的利器！"><meta property='og:url' content='https://chengxiaqiucao.github.io/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/'><meta property='og:site_name' content='秋 草 观 “测” 台'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='测试技术'><meta property='article:tag' content='Windows'><meta property='article:published_time' content='2025-03-01T15:13:59+08:00'><meta property='article:modified_time' content='2025-03-01T15:13:59+08:00'><meta property='og:image' content='https://chengxiaqiucao.github.io/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/%E6%89%B9%E5%A4%84%E7%90%86For%E5%91%BD%E4%BB%A4_%E5%85%AC%E4%BC%97%E5%8F%B7.jpg'><meta name=twitter:title content="批处理脚本之For命令"><meta name=twitter:description content="For命令是批处理脚本中提效的利器！"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://chengxiaqiucao.github.io/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/%E6%89%B9%E5%A4%84%E7%90%86For%E5%91%BD%E4%BB%A4_%E5%85%AC%E4%BC%97%E5%8F%B7.jpg'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/automnGrass_hu_5e44a092fd905642.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>秋 草 观 “测” 台</a></h1><h2 class=site-description>Testing is not just checking...</h2></div></header><ol class=menu-social><li><a href=https://github.com/chengxiaqiucao target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://space.bilibili.com/472272606 target=_blank title=Bilibili rel=me><!doctype html><svg t="1750732982440" class="icon" viewBox="0 0 1024 1024" p-id="4593" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632 444.330667 256h135.296l138.368-138.325333A42.666667 42.666667.0 01778.368 178.048L700.330667 256H789.333333A149.333333 149.333333.0 01938.666667 405.333333v341.333334A149.333333 149.333333.0 01789.333333 896H234.666667A149.333333 149.333333.0 0185.333333 746.666667V405.333333A149.333333 149.333333.0 01234.666667 256h88.96L245.632 177.962667a42.666667 42.666667.0 0160.373333-60.373334zm483.328 223.701333H234.666667a64 64 0 00-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0057.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0063.701334-57.856L853.333333 746.666667V405.333333a64 64 0 00-64-64zm-448 128A42.666667 42.666667.0 01384 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666666-42.666667zm341.333334.0A42.666667 42.666667.0 01725.333333 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666667-42.666667z" p-id="4594" fill="#8a8a8a"/></svg></a></li><li><a href=https://www.zhihu.com/people/qiucao target=_blank title=zhihu rel=me><!doctype html><svg t="1750733049138" class="icon" viewBox="0 0 1024 1024" p-id="5820" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M570.581333 806.272h61.952L652.928 876.117333 764.074667 806.272h130.986666V230.186667h-324.48V806.272zM636.501333 292.693333h192.64V743.68h-73.898666l-73.813334 46.378667L668.032 743.808l-31.530667-.128V292.736zM515.754667 493.738667H377.429333a2999.466667 2999.466667.0 005.802667-194.56h135.338667S523.776 239.445334 495.872 240.128H261.76c9.216-34.730667 20.821333-70.613333 34.688-107.690667.0.0-63.701333.0-85.333333 57.130667C202.112 213.12 176.128 303.786667 129.877333 396.416c15.573333-1.706667 67.114667-3.114667 97.450667-58.794667 5.589333-15.616 6.656-17.621333 13.568-38.485333h76.373333c0 27.776-3.157333 177.109333-4.437333 194.474667h-138.24c-31.104.0-41.173333 62.549333-41.173333 62.549333h173.482666C295.253333 688.256 232.789333 799.573333 119.466667 887.466667c54.186667 15.488 108.202667-2.432 134.912-26.197334.0.0 60.8-55.338667 94.122666-183.381333L491.264 849.834667s20.906667-71.168-3.285333-105.856c-20.053333-23.637333-74.24-87.552-97.322667-110.72l-38.698667 30.72c11.52-36.992 18.474667-72.96 20.821334-107.690667h163.072s-.213333-62.549333-20.053334-62.549333z" p-id="5821" fill="#8a8a8a"/></svg></a></li><li><a href=mailto:%20danmyw@qq.com target=_blank title=e-mail rel=me><!doctype html><svg t="1750733089669" class="icon" viewBox="0 0 1451 1024" p-id="6983" xmlns:xlink="http://www.w3.org/1999/xlink" width="283.3984375" height="200"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z" fill="#8a8a8a" p-id="6984"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>检索</span></a></li><li><a href=/page/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li><a href=/page/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/page/releases/><svg class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg>
<span>热门开源</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://chengxiaqiucao.github.io/en/>English</option><option value=https://chengxiaqiucao.github.io/ selected>中文</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#for-命令介绍>For 命令介绍</a><ol><li><a href=#基础语法><strong>基础语法</strong></a></li><li><a href=#-r参数递归遍历文件>** <code>/R</code>参数：递归遍历文件**</a></li><li><a href=#d><strong><code>/D</code>：处理目录</strong></a><ol><li><a href=#4><strong>4. <code>/L</code>：生成数字序列</strong></a></li></ol></li><li><a href=#f><strong><code>/F</code>：高级文本解析（核心参数）</strong></a><ol><li></li><li><a href=#f-1><strong><code>/F</code> 的常用选项</strong></a></li><li><a href=#usebackq><strong><code>usebackq</code> 的作用</strong></a></li></ol></li></ol></li><li><a href=#应用场景总结><strong>应用场景总结</strong></a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/><img src=/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/%E6%89%B9%E5%A4%84%E7%90%86For%E5%91%BD%E4%BB%A4_%E5%85%AC%E4%BC%97%E5%8F%B7_hu_e78ba0b1ba8be3ae.jpg srcset="/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/%E6%89%B9%E5%A4%84%E7%90%86For%E5%91%BD%E4%BB%A4_%E5%85%AC%E4%BC%97%E5%8F%B7_hu_e78ba0b1ba8be3ae.jpg 800w, /post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/%E6%89%B9%E5%A4%84%E7%90%86For%E5%91%BD%E4%BB%A4_%E5%85%AC%E4%BC%97%E5%8F%B7_hu_64b2ea91b60d3abe.jpg 1600w" width=800 height=340 loading=lazy alt="Featured image of post 批处理脚本之For命令"></a></div><div class=article-details><header class=article-category><a href=/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/ style=background-color:#2a9d8f;color:#fff>测试技术</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/>批处理脚本之For命令</a></h2><h3 class=article-subtitle>For命令是批处理脚本中提效的利器！</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 01, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 4 分钟</time></div></footer></div></header><section class=article-content><h2 id=前言>前言</h2><p>在我们工作中，如果使用Windows系统，善用批处理命令，特别是在批量的文件处理，文本处理时能帮助我们极大地提升工作效率，起到事半功倍的效果！</p><p>但很多同学，对批处理的使用更多还停留在可以将多个command命令组合到一起执行，省去重复敲命令和等待的时间。这个其实只是批处理脚本最基本的使用方法</p><p>但要充分发挥批处理的作用，批处理脚本中的 <code>for</code> 命令其实才是核心，它作为一个兼顾循环处理，和文本列处理的命令工具，在提升批处理脚本效率方面，无出其右！</p><p>但 for 命令的使用，相对比较复杂，很多同学可能并未很好掌握，所以本文，我们带来关于批处理中这个核心命令的系统介绍</p><blockquote><p>文中还有一个秋草发现的彩蛋，微软竟然有一个官方陈年Bug一直没有修 😂😂😂</p></blockquote><h2 id=for-命令介绍>For 命令介绍</h2><p>下面我们就来详细介绍这个 windows 批处理中的重磅命令</p><h3 id=基础语法><strong>基础语法</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=k>FOR</span> %variable <span class=k>IN</span> <span class=p>(</span>set<span class=p>)</span> <span class=k>DO</span> command [command-parameters]
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>%variable</strong>: for循环变量，批处理脚本中需用 <code>%%</code>，命令行直接执行用 <code>%</code></li><li>(<strong>set)</strong>： 可以是文件、目录、字符串或命令输出。。</li><li><strong>command</strong>： 指定对每组循环执行的命令。</li><li><strong>command-parameters</strong>： 控制循环行为（如 <code>/R</code>, <code>/D</code>, <code>/L</code>, <code>/F</code> 等）</li></ul><p>如遍历集合:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span>苹果 香蕉 <span class=s2>&#34;西瓜 芒果&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=k>echo</span> 水果：<span class=se>%%</span>a
</span></span></code></pre></td></tr></table></div></div><p><strong>输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>水果：苹果
</span></span><span class=line><span class=cl>水果：香蕉
</span></span><span class=line><span class=cl>水果：&#34;西瓜 芒果&#34;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>说明</strong>：默认按空格分隔元素，带引号的字符串视为整体。</li></ul><hr><h3 id=-r参数递归遍历文件>** <code>/R</code>参数：递归遍历文件**</h3><p>这个参数，用于递归遍历目录及其子目录中的文件。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> /R <span class=s2>&#34;C:\Chengxiaqiucao&#34;</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span>*.txt<span class=p>)</span> <span class=k>do</span> <span class=k>echo</span> 找到文件：<span class=se>%%</span>a
</span></span></code></pre></td></tr></table></div></div><p><strong>功能</strong>：</p><ul><li>遍历 <code>C:\Chengxiaqiucao</code> 及其子目录下的所有 <code>.txt</code> 文件。</li><li><code>%%a</code> 会包含完整文件路径（如 <code>C:\Chengxiaqiucao\test\file.txt</code>）。</li></ul><hr><h3 id=d><strong><code>/D</code>：处理目录</strong></h3><p>这个参数会仅遍历目录（不处理文件）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> /D <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span><span class=s2>&#34;C:\*&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=k>echo</span> 目录：<span class=se>%%</span>a
</span></span></code></pre></td></tr></table></div></div><p><strong>功能</strong>：</p><ul><li>列出 <code>C:\</code> 下的所有一级目录（如 <code>Program Files</code>, <code>Users</code> 等）。</li></ul><hr><h4 id=4><strong>4. <code>/L</code>：生成数字序列</strong></h4><p>这个参数和我们编程时控制循环次数比较类似。</p><p><strong>语法</strong>：<code>for /L %%a in (起始, 步长, 结束)</code></p><p>如下例生成等差数列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=k>/L</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span><span class=mi>1</span>, <span class=mi>2</span>, <span class=mi>10</span><span class=p>)</span> <span class=k>do</span> <span class=k>echo</span> 当前数字：<span class=se>%%</span>a
</span></span></code></pre></td></tr></table></div></div><p><strong>输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>当前数字：1
</span></span><span class=line><span class=cl>当前数字：3
</span></span><span class=line><span class=cl>当前数字：5
</span></span><span class=line><span class=cl>当前数字：7
</span></span><span class=line><span class=cl>当前数字：9
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=f><strong><code>/F</code>：高级文本解析（核心参数）</strong></h3><p>这个参数可以说是 For 命令最核心的参数，For命令大展身手，大部分情况下都是这个参数的功劳。</p><p>这个参数主要用于逐行解析文本、字符串或命令输出，并支持复杂规则。</p><h5 id=语法><strong>语法</strong>：</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=k>for</span> <span class=k>/F</span> [<span class=s2>&#34;选项&#34;</span>] <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span>数据源<span class=p>)</span> <span class=k>do</span> 命令
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>数据源</strong>：文件、字符串或命令输出（用反引号 <code>`</code> 包裹）。</li><li><strong>选项</strong>：<code>delims</code>, <code>tokens</code>, <code>skip</code>, <code>eol</code>, <code>usebackq</code> 等。</li></ul><hr><h4 id=f-1><strong><code>/F</code> 的常用选项</strong></h4><div class=table-wrapper><table><thead><tr><th>选项</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td><code>delims=xyz</code></td><td>定义分隔符（默认空格/制表符）</td><td><code>delims=,</code> 按逗号分割</td></tr><tr><td><code>tokens=n</code></td><td>提取第n列（多列用逗号分隔，如 <code>1,3</code>）</td><td><code>tokens=2</code> 提取第二列</td></tr><tr><td><code>skip=n</code></td><td>跳过前n行</td><td><code>skip=2</code> 跳过前两行</td></tr><tr><td><code>eol=;</code></td><td>定义行注释符（默认 <code>;</code>）</td><td><code>eol=#</code> 忽略以 <code>#</code> 开头的行</td></tr><tr><td><code>usebackq</code></td><td>改变数据源引用方式（见下文）</td><td>处理带空格路径或命令输出</td></tr></tbody></table></div><hr><h4 id=usebackq><strong><code>usebackq</code> 的作用</strong></h4><h5 id=此处有彩蛋官方文档中的bug>此处有彩蛋：官方文档中的Bug</h5><p>在windows的中文官方帮助中，对 <code>-F</code> 参数的说明，其实是错误的</p><p><img src=/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303.png width=1134 height=927 srcset="/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303_hu_69c28a787679498a.png 480w, /post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303_hu_6b054e8443412a20.png 1024w" loading=lazy class=gallery-image data-flex-grow=122 data-flex-basis=293px></p><p>可以看到，这里对使用 <code>usebackq</code> 的介绍和不使用该参数完全一样，而且，这里中文翻译的非常拗口，很难理解什么意思</p><p>不过，我们通过 <code>chcp 65001</code> 命令将命令行代码页切换至utf8，这时查看帮助会显示英文帮助</p><p><img src=/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303-1.png width=882 height=1016 srcset="/post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303-1_hu_58dff411620f63af.png 480w, /post/063-%E6%89%B9%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC%E4%B9%8Bfor%E5%91%BD%E4%BB%A4/Pasted-20250303-1_hu_70197c22987e192e.png 1024w" loading=lazy class=gallery-image data-flex-grow=86 data-flex-basis=208px></p><p>可以看到，理解起来就清晰多了， <code>usebackq</code>解决以下场景的问题：</p><ol><li><strong>处理带空格的文件路径</strong>：用双引号引用文件名。</li><li><strong>执行命令并解析输出</strong>：用反引号 <code>`</code> 引用系统命令。</li><li><strong>直接解析字符串</strong>：用单引号 <code>'</code> 引用字符串。</li></ol><h5 id=案例一><strong>案例一</strong>：</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=k>/F</span> <span class=s2>&#34;usebackq delims=&#34;</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span><span class=s2>&#34;C:\My Files\data.txt&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=k>echo</span> <span class=se>%%</span>a
</span></span></code></pre></td></tr></table></div></div><ul><li>若不使用 <code>usebackq</code>，路径中的空格会导致解析错误。</li></ul><hr><h5 id=-案例二>** 案例二**</h5><p>解析 <code>data.csv</code>（格式：<code>姓名,年龄,城市</code>），跳过标题行，提取姓名和城市。</p><p><strong>输入文件 <code>data.csv</code></strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>姓名,年龄,城市
</span></span><span class=line><span class=cl>张三,25,北京
</span></span><span class=line><span class=cl>李四,30,上海
</span></span></code></pre></td></tr></table></div></div><p>批处理：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-batch data-lang=batch><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=k>/F</span> <span class=s2>&#34;usebackq skip=1 delims=, tokens=1,3&#34;</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span><span class=s2>&#34;data.csv&#34;</span><span class=p>)</span> <span class=k>do</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> 姓名：<span class=se>%%</span>a，城市：<span class=se>%%</span>b
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>姓名：张三，城市：北京
</span></span><span class=line><span class=cl>姓名：李四，城市：上海
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=应用场景总结><strong>应用场景总结</strong></h2><div class=table-wrapper><table><thead><tr><th>参数</th><th>适用场景</th><th>典型命令示例</th></tr></thead><tbody><tr><td>无参数</td><td>遍历简单文件或字符串列表</td><td><code>for %%a in (*.txt) do echo %%a</code></td></tr><tr><td><code>/R</code></td><td>递归处理目录下的文件</td><td><code>for /R %%a in (*.log) do del %%a</code></td></tr><tr><td><code>/D</code></td><td>仅处理目录</td><td><code>for /D %%a in (C:\*) do echo %%a</code></td></tr><tr><td><code>/L</code></td><td>生成数字序列（如循环固定次数）</td><td><code>for /L %%a in (1,1,5) do echo %%a</code></td></tr><tr><td><code>/F</code></td><td>解析文本文件、命令输出或复杂字符串</td><td><code>for /F "tokens=2" %%a in (data.txt)</code></td></tr></tbody></table></div><p>所以通过掌握For命令的这些参数和技巧，完全可以让它成为批处理脚本中处理文件、文本和系统任务的“瑞士军刀”。</p><hr></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/>测试技术</a>
<a href=/tags/windows/>Windows</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/101-testmybookshelf/><div class=article-image><img src=/post/101-testmybookshelf/snap_20250611.587c273dec8eb9a41c3169765e22b5a4_hu_77aaf477deac86f2.png width=250 height=150 loading=lazy alt="Featured image of post 开源一个测试练习项目，邀请大家共建" data-hash="md5-WHwnPeyOuaQcMWl2XiK1pA=="></div><div class=article-details><h2 class=article-title>开源一个测试练习项目，邀请大家共建</h2></div></a></article><article class=has-image><a href=/post/096-docker%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96/><div class=article-image><img src=/post/096-docker%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96/Docker%E8%87%AA%E5%8A%A8%E5%8C%96.77990f128e134aea0434ce61fa277ed7_hu_e3b7fde4ec55ce32.png width=250 height=150 loading=lazy alt="Featured image of post  自动化测试中应用Docker的正反两面" data-hash="md5-d5kPEo4TSuoENM5h+id+1w=="></div><div class=article-details><h2 class=article-title>自动化测试中应用Docker的正反两面</h2></div></a></article><article class=has-image><a href=/post/084-aria%E4%BB%8B%E7%BB%8D/><div class=article-image><img src=/post/084-aria%E4%BB%8B%E7%BB%8D/-20250417.3717a89b9e3a59cfc38496c6374f9fa3_hu_fa0ca31016c1b2b3.png width=250 height=150 loading=lazy alt="Featured image of post W3C ARIA Roles标准及其在AI驱动自动化测试中的作用" data-hash="md5-Nxeom546Wc/DhJbGN0+fow=="></div><div class=article-details><h2 class=article-title>W3C ARIA Roles标准及其在AI驱动自动化测试中的作用</h2></div></a></article><article><a href=/post/083-ai%E6%B5%8B%E8%AF%95%E8%B7%AF%E7%BA%BF%E5%9B%BE/><div class=article-details><h2 class=article-title>AI测试，测试团队的必由之路</h2></div></a></article><article><a href=/post/074-%E6%9C%80%E6%96%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E8%B6%8B%E5%8A%BF2025/><div class=article-details><h2 class=article-title>转译：2025自动化测试八大趋势</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 |by 城下秋草（公众号： 秋草说测试）</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>
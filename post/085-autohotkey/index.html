<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="前言 之前在介绍Markdown文档中图片处理方法的文章 【本地Markdown编写的文档，发布到网上如何处理图片？】 中，介绍了可以使用\u00a0AutoHotKey\u00a0来辅助完成截图和链接的自动生成。有小伙伴私信问这个工具的具体用法。\n"><title>AutoHotKey：让效率倍增的桌面自动化利器</title><link rel=canonical href=https://chengxiaqiucao.github.io/post/085-autohotkey/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="AutoHotKey：让效率倍增的桌面自动化利器"><meta property='og:description' content="前言 之前在介绍Markdown文档中图片处理方法的文章 【本地Markdown编写的文档，发布到网上如何处理图片？】 中，介绍了可以使用\u00a0AutoHotKey\u00a0来辅助完成截图和链接的自动生成。有小伙伴私信问这个工具的具体用法。\n"><meta property='og:url' content='https://chengxiaqiucao.github.io/post/085-autohotkey/'><meta property='og:site_name' content='秋 草 观 “测” 台'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='测试工具'><meta property='article:tag' content='Windows'><meta property='article:published_time' content='2025-04-29T00:00:00+00:00'><meta property='article:modified_time' content='2025-04-29T00:00:00+00:00'><meta name=twitter:title content="AutoHotKey：让效率倍增的桌面自动化利器"><meta name=twitter:description content="前言 之前在介绍Markdown文档中图片处理方法的文章 【本地Markdown编写的文档，发布到网上如何处理图片？】 中，介绍了可以使用\u00a0AutoHotKey\u00a0来辅助完成截图和链接的自动生成。有小伙伴私信问这个工具的具体用法。\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/automnGrass_hu_5e44a092fd905642.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>秋 草 观 “测” 台</a></h1><h2 class=site-description>Testing is not just checking...</h2></div></header><ol class=menu-social><li><a href=https://github.com/chengxiaqiucao target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://space.bilibili.com/472272606 target=_blank title=Bilibili rel=me><!doctype html><svg t="1750732982440" class="icon" viewBox="0 0 1024 1024" p-id="4593" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632 444.330667 256h135.296l138.368-138.325333A42.666667 42.666667.0 01778.368 178.048L700.330667 256H789.333333A149.333333 149.333333.0 01938.666667 405.333333v341.333334A149.333333 149.333333.0 01789.333333 896H234.666667A149.333333 149.333333.0 0185.333333 746.666667V405.333333A149.333333 149.333333.0 01234.666667 256h88.96L245.632 177.962667a42.666667 42.666667.0 0160.373333-60.373334zm483.328 223.701333H234.666667a64 64 0 00-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0057.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0063.701334-57.856L853.333333 746.666667V405.333333a64 64 0 00-64-64zm-448 128A42.666667 42.666667.0 01384 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666666-42.666667zm341.333334.0A42.666667 42.666667.0 01725.333333 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666667-42.666667z" p-id="4594" fill="#8a8a8a"/></svg></a></li><li><a href=https://www.zhihu.com/people/qiucao target=_blank title=zhihu rel=me><!doctype html><svg t="1750733049138" class="icon" viewBox="0 0 1024 1024" p-id="5820" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M570.581333 806.272h61.952L652.928 876.117333 764.074667 806.272h130.986666V230.186667h-324.48V806.272zM636.501333 292.693333h192.64V743.68h-73.898666l-73.813334 46.378667L668.032 743.808l-31.530667-.128V292.736zM515.754667 493.738667H377.429333a2999.466667 2999.466667.0 005.802667-194.56h135.338667S523.776 239.445334 495.872 240.128H261.76c9.216-34.730667 20.821333-70.613333 34.688-107.690667.0.0-63.701333.0-85.333333 57.130667C202.112 213.12 176.128 303.786667 129.877333 396.416c15.573333-1.706667 67.114667-3.114667 97.450667-58.794667 5.589333-15.616 6.656-17.621333 13.568-38.485333h76.373333c0 27.776-3.157333 177.109333-4.437333 194.474667h-138.24c-31.104.0-41.173333 62.549333-41.173333 62.549333h173.482666C295.253333 688.256 232.789333 799.573333 119.466667 887.466667c54.186667 15.488 108.202667-2.432 134.912-26.197334.0.0 60.8-55.338667 94.122666-183.381333L491.264 849.834667s20.906667-71.168-3.285333-105.856c-20.053333-23.637333-74.24-87.552-97.322667-110.72l-38.698667 30.72c11.52-36.992 18.474667-72.96 20.821334-107.690667h163.072s-.213333-62.549333-20.053334-62.549333z" p-id="5821" fill="#8a8a8a"/></svg></a></li><li><a href=mailto:%20danmyw@qq.com target=_blank title=e-mail rel=me><!doctype html><svg t="1750733089669" class="icon" viewBox="0 0 1451 1024" p-id="6983" xmlns:xlink="http://www.w3.org/1999/xlink" width="283.3984375" height="200"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z" fill="#8a8a8a" p-id="6984"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/page/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>检索</span></a></li><li><a href=/page/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li><a href=/page/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/page/releases/><svg class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg>
<span>热门开源</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://chengxiaqiucao.github.io/en/>English</option><option value=https://chengxiaqiucao.github.io/ selected>中文</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#ahk简介>AHK简介</a></li><li><a href=#ahk-核心语法与常用函数>AHK 核心语法与常用函数</a><ol><li><a href=#基础热键>**基础热键</a></li><li><a href=#热字串>热字串</a></li><li><a href=#核心命令函数><strong>核心命令函数</strong></a></li><li><a href=#变量与表达式><strong>变量与表达式</strong></a></li></ol></li><li><a href=#实用案例说明>实用案例说明</a><ol><li><a href=#案例-1截图自动生成-markdown-图片链接>案例 1：截图自动生成 Markdown 图片链接</a></li><li><a href=#案例-2一键执行复杂命令序列>案例 2：一键执行复杂命令序列</a></li><li><a href=#案例-3自动化测试数据生成>案例 3：自动化测试数据生成</a></li></ol></li><li><a href=#总结为什么使用autohotkey>总结：为什么使用AutoHotKey？</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E5%85%B6%E4%BB%96/ style=background-color:#12f0eb;color:#666>其他</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/085-autohotkey/>AutoHotKey：让效率倍增的桌面自动化利器</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 29, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 5 分钟</time></div></footer></div></header><section class=article-content><h2 id=前言>前言</h2><p>之前在介绍Markdown文档中图片处理方法的文章 【<a class=link href=https://mp.weixin.qq.com/s/Mom021usUHUFwE8aGXVtVg target=_blank rel=noopener>本地Markdown编写的文档，发布到网上如何处理图片？</a>】 中，介绍了可以使用 <strong>AutoHotKey</strong> 来辅助完成截图和链接的自动生成。有小伙伴私信问这个工具的具体用法。</p><p>下文我们就比较系统地介绍下这个工具，了解通过ahk的脚本魔法，如何让重复操作一键完成！</p><h2 id=ahk简介>AHK简介</h2><p>在追求效率的软件开发与技术工作中，<strong>重复性操作</strong>往往吞噬宝贵时间。AutoHotkey（AHK）作为一款轻量级、开源的<strong>Windows桌面自动化工具</strong>。可以通过编写简洁的脚本，将用户从繁琐、重复的键盘鼠标操作中解放出来，显著提升工作效率。</p><p>理解AHK的关键在于其<strong>脚本语言</strong>。核心功能包括模拟键盘输入（<code>Send</code>）、鼠标操作（<code>Click</code>）、程序运行（<code>Run</code>）、条件判断（<code>If</code>）和循环控制（<code>Loop</code>）等。用户无需编译环境，脚本文件（<code>.ahk</code>）可直接运行，资源占用极低。</p><p>AHK的应用场景极为广泛。简单如自动填写表单、快捷输入预设短语；进阶如批量重命名文件、自动化软件测试、定制专属工作流；甚至可开发带有图形界面（GUI）的小工具。其强大之处在于<strong>深度集成Windows系统</strong>，能够操作窗口、读写注册表、访问文件系统，实现高度的定制化自动化。</p><p>简单来说，AutoHotKey 赋予了用户<strong>用脚本指挥电脑</strong>的能力。无论是开发者、办公人员还是追求效率的普通用户，都能通过它定制专属的“快捷键魔法”，将重复劳动转化为瞬间完成的自动化操作。</p><h2 id=ahk-核心语法与常用函数>AHK 核心语法与常用函数</h2><h3 id=基础热键>**基础热键</h3><ul><li><strong>热键定义</strong>：由一个热键后跟双冒号组成.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=o>^</span><span class=n>j</span><span class=o>::</span><span class=c1>  ; Ctrl+J 热键</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	<span class=nb>Send</span><span class=p>,</span> <span class=n>Hello</span> <span class=n>World</span><span class=o>!</span><span class=c1>  ; 发送文本</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>	<span class=nb>return</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>如果只有一行执行的操作， <code>return</code> 也可省略</p><div class=table-wrapper><table><thead><tr><th>符号</th><th>描述</th></tr></thead><tbody><tr><td><strong><code>#</code></strong></td><td>Win 键 (Windows 徽标键)<br>- 等待 Win 释放后发送文本（Vista+）<br>- 可能导致额外模拟击键（详见 <code>#MenuMaskKey</code>)</td></tr><tr><td><strong><code>!</code></strong></td><td>Alt 键<br>- 可能导致额外模拟击键（详见 <code>#MenuMaskKey</code>)</td></tr><tr><td><strong><code>^</code></strong></td><td>Ctrl 键</td></tr><tr><td><strong><code>+</code></strong></td><td>Shift 键</td></tr><tr><td><strong><code>&</code></strong></td><td>组合任意两个按键/鼠标按钮创建自定义热键</td></tr><tr><td><strong><code>&lt;</code></strong></td><td>使用成对按键中的左侧键（如 <code>&lt;!a</code> 仅左 Alt 触发）</td></tr><tr><td><strong><code>></code></strong></td><td>使用成对按键中的右侧键</td></tr><tr><td><strong><code>&lt;^>!</code></strong></td><td>AltGr 键（替代图形键）<br>- 表示 AltGr 组合键（如 <code>&lt;^>!m</code>）<br>- 单独使用：<code>LControl & RAlt</code></td></tr><tr><td><strong><code>*</code></strong></td><td>通配符：即使附加修饰键按住也能触发<br>- 示例：<code>*#c</code>（Win+C/Shift+Win+C 等均触发）<br>- 强制使用键盘钩子</td></tr><tr><td><strong><code>~</code></strong></td><td>保留按键原生功能（不屏蔽操作系统事件）<br>- 示例：<code>~RButton</code>（右键点击仍发送到窗口）<br>- 影响所有组合行为<br>- 强制使用键盘钩子</td></tr><tr><td><strong><code>$</code></strong></td><td>强制使用键盘钩子，避免 Send 命令触发自身<br>- 对鼠标热键无效<br>- 替代方案：<code>#InputLevel</code>/<code>SendLevel</code> (v1.1.06+)</td></tr><tr><td><strong><code>UP</code></strong></td><td>在按键释放时触发（非按下时）<br>- 示例：<code>^!r Up::</code>（释放 Ctrl+Alt+R 触发）<br>- 限制：<br>1) 不适用于控制器按钮<br>2) 需配合普通热键避免卡键</td></tr></tbody></table></div><p><strong>示例</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=nl>#a::</span><span class=n>Run</span> <span class=n>Calculator</span><span class=c1>              ; Win+A 启动计算器</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>^!+</span><span class=n>s</span><span class=o>::</span><span class=n>Send</span> <span class=n>Hello</span> <span class=n>World</span><span class=c1>         ; Ctrl+Alt+Shift+S 发送文本</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>~</span><span class=n>RButton</span><span class=o>::</span><span class=n>MsgBox</span> <span class=n>Right</span> <span class=n>Click</span><span class=c1>   ; 保留右键原生功能的弹窗</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=n>LWin</span> <span class=o>&amp;</span> <span class=n>R</span><span class=o>::</span><span class=n>Reload</span><span class=c1>               ; 左Win+R 重载脚本</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>*</span><span class=n>#c</span><span class=o>::</span><span class=n>Run</span> <span class=n>cmd</span><span class=o>.</span><span class=n>exe</span><span class=c1>               ; 任何修饰键+Win+C 启动命令提示符</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=o>^!</span><span class=n>r</span> <span class=n>Up</span><span class=o>::</span><span class=n>MsgBox</span> <span class=n>Released</span><span class=c1>       ; 释放组合键时触发</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=热字串>热字串</h3><ul><li><strong>热字串</strong>：由一个冒号, 零个或多个选项, 另一个冒号, 缩写字符和双冒号组成.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=o>:*:</span><span class=n>btw</span><span class=o>::</span> <span class=n>by</span> <span class=n>the</span> <span class=n>way</span><span class=c1>  ; 输入btw后按空格/回车替换</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>或者也可以通过热字串执行复杂些的操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=o>:*:</span><span class=p>]</span><span class=n>d</span><span class=o>::</span><span class=c1>  ; 此热字串通过后面的命令把 &#34;]d&#34; 替换成当前日期和时间.</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>FormatTime</span><span class=p>,</span> <span class=n>CurrentDateTime</span><span class=p>,,</span> <span class=n>M</span><span class=o>/</span><span class=n>d</span><span class=o>/</span><span class=n>yyyy</span> <span class=n>h</span><span class=o>:</span><span class=n>mm</span> <span class=n>tt</span><span class=c1>  ; </span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>SendInput</span> <span class=nv>%CurrentDateTime%</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>return</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=核心命令函数><strong>核心命令函数</strong></h3><p>常用的一些核心函数包括：</p><div class=table-wrapper><table><thead><tr><th>函数名</th><th>类别</th><th>描述</th></tr></thead><tbody><tr><td><strong><code>FileExist</code></strong></td><td>文件操作</td><td>检查文件/文件夹是否存在并返回属性（如 &ldquo;D&rdquo; 表示目录）</td></tr><tr><td><strong><code>GetKeyState</code></strong></td><td>输入检测</td><td>检测键盘/鼠标按键状态，返回 1（按下）或 0（松开）</td></tr><tr><td><strong><code>InStr</code></strong></td><td>字符串处理</td><td>查找子串在字符串中的位置，支持从左/右搜索</td></tr><tr><td><strong><code>StrLen</code></strong></td><td>字符串处理</td><td>获取字符串长度（字节数或字符数）</td></tr><tr><td><strong><code>SubStr</code></strong></td><td>字符串处理</td><td>截取字符串指定位置开始的子串</td></tr><tr><td><strong><code>WinActive</code></strong></td><td>窗口控制</td><td>检测指定窗口是否活动，返回窗口句柄（HWND）</td></tr><tr><td><strong><code>WinExist</code></strong></td><td>窗口控制</td><td>检测指定窗口是否存在，返回首个匹配窗口句柄</td></tr><tr><td><strong><code>Format</code></strong></td><td>数据处理</td><td>格式化字符串（类似 sprintf 功能）</td></tr><tr><td><strong><code>DllCall</code></strong></td><td>系统交互</td><td>调用 Windows API 等外部 DLL 函数</td></tr><tr><td><strong><code>Run</code></strong></td><td>进程控制</td><td>启动程序/执行命令（已在初稿列出，此处补充完整描述）</td></tr></tbody></table></div><p><strong>示例:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=c1>; 组合使用示例</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>if </span><span class=nf>WinActive</span><span class=p>(</span><span class=s>&#34;ahk_exe chrome.exe&#34;</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nf>GetKeyState</span><span class=p>(</span><span class=s>&#34;Ctrl&#34;</span><span class=p>,</span> <span class=s>&#34;P&#34;</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>FileAppend</span><span class=p>,</span> <span class=o>%</span><span class=n>Format</span><span class=p>(</span><span class=s>&#34;[%time%] Ctrl pressed in Chrome`n&#34;</span><span class=p>)</span><span class=o>%</span><span class=p>,</span> <span class=nf>log</span><span class=o>.</span><span class=n>txt</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>Send</span> <span class=o>^</span><span class=p>{</span><span class=n>t</span><span class=p>}</span><span class=c1>  ; 在Chrome中新建标签页</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=变量与表达式><strong>变量与表达式</strong></h3><ul><li>变量无需声明，直接赋值（如 <code>count := 10</code>）</li><li>支持字符串拼接（<code>.</code> 运算符）与数学运算</li></ul><h2 id=实用案例说明>实用案例说明</h2><h3 id=案例-1截图自动生成-markdown-图片链接>案例 1：截图自动生成 Markdown 图片链接</h3><p><strong>痛点</strong>：手动截图→保存→复制路径→插入 Markdown 繁琐
<strong>解决方案</strong>：一键完成截图并生成标准链接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=nl>#s::</span><span class=c1>  ; Win+S 快捷键</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Run</span><span class=p>,</span> <span class=nv>%A_WinDir%</span>\<span class=n>System32</span>\<span class=n>SnippingTool</span><span class=o>.</span><span class=n>exe</span><span class=c1>  ; 启动截图工具</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>WinWaitActive</span><span class=p>,</span> <span class=n>Snip</span> <span class=o>&amp;</span> <span class=n>Sketch</span><span class=c1>  ; 等待窗口激活</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Send</span><span class=p>,</span> <span class=o>^+</span><span class=n>n</span><span class=c1>  ; 模拟新建截图快捷键（Ctrl+Shift+N）</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>WinWaitActive</span><span class=p>,</span> <span class=n>ahk_class</span> <span class=n>Microsoft</span><span class=o>.</span><span class=n>ScreenSketch</span><span class=c1>  ; 等待截图完成</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Send</span><span class=p>,</span> <span class=o>^</span><span class=n>s</span><span class=c1>  ; 保存截图</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>WinWaitActive</span><span class=p>,</span> <span class=n>Save</span> <span class=n>As</span><span class=c1>  ; 等待保存对话框</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>FormatTime</span><span class=p>,</span> <span class=n>CurrentTime</span><span class=p>,,</span> <span class=n>yyyyMMdd_HHmmss</span><span class=c1>  ; 生成时间戳文件名</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>SendInput</span><span class=p>,</span> <span class=nv>%CurrentTime%</span><span class=o>.</span><span class=n>png</span><span class=p>{</span><span class=n>Enter</span><span class=p>}</span><span class=c1>  ; 输入文件名</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Sleep</span><span class=p>,</span> <span class=mi>1000</span><span class=c1>  ; 等待保存完成</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nv>clipboard</span> <span class=o>:=</span> <span class=s>&#34;![](&#34;</span> <span class=o>.</span> <span class=nv>A_Desktop</span> <span class=o>.</span> <span class=s>&#34;\&#34;</span> <span class=o>.</span> <span class=n>CurrentTime</span> <span class=o>.</span> <span class=s>&#34;.png)&#34;</span><span class=c1>  ; 生成MD链接</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>MsgBox</span><span class=p>,</span> <span class=n>Markdown截图链接已复制到剪贴板</span><span class=err>！
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>return</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>效果</strong>：按 Win+S → 截图 → 自动保存为带时间戳的 PNG → 剪贴板生成 <code>![](路径)</code> 格式链接。</p><h3 id=案例-2一键执行复杂命令序列>案例 2：一键执行复杂命令序列</h3><p><strong>痛点</strong>：部署环境需重复输入多条命令
<strong>解决方案</strong>：单键触发命令组合</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=o>^!</span><span class=n>d</span><span class=o>::</span><span class=c1>  ; Ctrl+Alt+D</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Run</span><span class=p>,</span> <span class=n>cmd</span><span class=o>.</span><span class=n>exe</span><span class=p>,</span> <span class=n>C</span><span class=o>:</span>\<span class=n>MyProject</span><span class=c1>  ; 打开CMD并进入项目目录</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>WinWaitActive</span><span class=p>,</span> <span class=n>ahk_class</span> <span class=n>ConsoleWindowClass</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Send</span><span class=p>,</span> <span class=n>git</span> <span class=n>pull</span> <span class=n>origin</span> <span class=n>main</span><span class=p>{</span><span class=n>Enter</span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Sleep</span><span class=p>,</span> <span class=mi>2000</span><span class=c1>  ; 等待git pull完成</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Send</span><span class=p>,</span> <span class=n>mvn</span> <span class=n>clean</span> <span class=n>install</span><span class=p>{</span><span class=n>Enter</span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Sleep</span><span class=p>,</span> <span class=mi>5000</span><span class=c1>  ; 等待Maven构建</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Send</span><span class=p>,</span> <span class=n>docker</span><span class=o>-</span><span class=n>compose</span> <span class=n>up</span> <span class=o>-</span><span class=n>d</span><span class=p>{</span><span class=n>Enter</span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>MsgBox</span><span class=p>,</span> <span class=err>环境部署命令已执行！
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>return</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>效果</strong>：一键完成代码拉取、项目构建、容器启动。</p><h3 id=案例-3自动化测试数据生成>案例 3：自动化测试数据生成</h3><p><strong>痛点</strong>：手动创建大量测试数据效率低下
<strong>解决方案</strong>：脚本批量生成结构化数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-autohotkey data-lang=autohotkey><span class=line><span class=cl><span class=nl>F9::</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=n>testData</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Loop</span><span class=p>,</span> <span class=mi>100</span> <span class=p>{</span><span class=c1>  ; 生成100条数据</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=n>name</span> <span class=o>:=</span> <span class=s>&#34;User&#34;</span> <span class=o>.</span> <span class=nv>A_Index</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=n>email</span> <span class=o>:=</span> <span class=s>&#34;user&#34;</span> <span class=o>.</span> <span class=nv>A_Index</span> <span class=o>.</span> <span class=s>&#34;@test.com&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=n>age</span> <span class=o>:=</span> <span class=n>Random</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>60</span><span class=p>)</span><span class=c1>  ; 自定义Random函数生成随机数</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=n>testData</span> <span class=o>.=</span> <span class=n>name</span> <span class=s>&#34;,&#34;</span> <span class=n>email</span> <span class=s>&#34;,&#34;</span> <span class=n>age</span> <span class=s>&#34;</span><span class=se>`n</span><span class=s>&#34;</span><span class=c1>  ; 拼接CSV格式</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>FileAppend</span><span class=p>,</span> <span class=nv>%testData%</span><span class=p>,</span> <span class=n>C</span><span class=o>:</span>\<span class=n>TestData</span>\<span class=n>users</span><span class=o>.</span><span class=n>csv</span><span class=c1>  ; 写入文件</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Run</span><span class=p>,</span> <span class=n>notepad</span><span class=o>.</span><span class=n>exe</span> <span class=n>C</span><span class=o>:</span>\<span class=n>TestData</span>\<span class=n>users</span><span class=o>.</span><span class=n>csv</span><span class=c1>  ; 打开查看</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>return</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>
</span></span><span class=line><span class=cl><span class=nb>Random</span><span class=p>(</span><span class=n>min</span><span class=p>,</span> <span class=n>max</span><span class=p>)</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>Random</span><span class=p>,</span> <span class=n>rand</span><span class=p>,</span> <span class=n>min</span><span class=p>,</span> <span class=n>max</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nb>return</span> <span class=n>rand</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>效果</strong>：按 F9 自动生成含用户名、邮箱、年龄的 100 条 CSV 测试数据。</p><hr><h2 id=总结为什么使用autohotkey>总结：为什么使用AutoHotKey？</h2><ol><li><strong>极简入门</strong>：语法接近自然语言，无需编译环境</li><li><strong>资源友好</strong>：轻量级（安装包 &lt; 3MB），后台占用可忽略</li><li><strong>深度集成</strong>：无缝操作窗口、注册表、文件系统</li><li><strong>生态丰富</strong>：官方论坛提供海量脚本库与插件支持</li><li><strong>跨场景适用</strong>：从文本处理到 GUI 自动化全覆盖</li></ol><blockquote><p>进一步学习：</p><ul><li>官方文档：<a class=link href=https://www.autohotkey.com/docs/ target=_blank rel=noopener>https://www.autohotkey.com/docs/</a></li><li>脚本仓库：<a class=link href=https://github.com/AutoHotkey target=_blank rel=noopener>https://github.com/AutoHotkey</a></li></ul></blockquote><p><strong>你的下一个自动化脚本，准备解决哪个痛点？</strong></p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/>测试工具</a>
<a href=/tags/windows/>Windows</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/010-windows%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C%E5%B0%8F%E6%8A%80%E5%B7%A7/><div class=article-details><h2 class=article-title>Win11操作小技巧二则</h2></div></a></article><article class=has-image><a href=/post/100-temp/><div class=article-image><img src=/post/100-temp/snap_20250604.b240d5be28dd0145f9f9637ca446c9d2_hu_a6f6e8e1b1a719e1.png width=250 height=150 loading=lazy alt="Featured image of post Github月度新锐热门工具 - 202506" data-hash="md5-skDVvijdAUX5+WN8pEbJ0g=="></div><div class=article-details><h2 class=article-title>Github月度新锐热门工具 - 202506</h2></div></a></article><article class=has-image><a href=/post/095-deepseek%E7%94%9F%E5%9B%BE/><div class=article-image><img src=/post/095-deepseek%E7%94%9F%E5%9B%BE/snap_20250613.e1187653bcbf21d0a3d1a08dfdde682e_hu_b41eb2798233b63c.png width=250 height=150 loading=lazy alt="Featured image of post AI技巧，用本地Deepseek也可以生图啦" data-hash="md5-4Rh2U7y/IdCj0aCN/d5oLg=="></div><div class=article-details><h2 class=article-title>AI技巧，用本地Deepseek也可以生图啦</h2></div></a></article><article><a href=/post/092-codebuddy/><div class=article-details><h2 class=article-title>Cursor收费？没事，咱们还有codebuddy！</h2></div></a></article><article><a href=/post/080-%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B/><div class=article-details><h2 class=article-title>提示词工程权威指南：赋能软件测试的艺术与科学</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 |by 城下秋草（公众号： 秋草说测试）</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>
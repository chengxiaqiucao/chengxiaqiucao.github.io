<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="在前文 【】和 【】中，我们分别对Bruno 这个近来备受关注的接口测试工具的优缺点和基本使用方法进行了介绍，本文我们会继续在上一篇的基础上，介绍 Bruno 和自动化测试相关的进阶用法\n"><title>可以抛弃postman啦, API测试工具Bruno实用教程(二)：进阶篇</title><link rel=canonical href=https://chengxiaqiucao.github.io/post/090-bruno%E8%BF%9B%E9%98%B6/><link rel=stylesheet href=/scss/style.min.d6334826c849a420a2748e4872b915ae516105f86c3993d9bad2032725f784b8.css><meta property='og:title' content="可以抛弃postman啦, API测试工具Bruno实用教程(二)：进阶篇"><meta property='og:description' content="在前文 【】和 【】中，我们分别对Bruno 这个近来备受关注的接口测试工具的优缺点和基本使用方法进行了介绍，本文我们会继续在上一篇的基础上，介绍 Bruno 和自动化测试相关的进阶用法\n"><meta property='og:url' content='https://chengxiaqiucao.github.io/post/090-bruno%E8%BF%9B%E9%98%B6/'><meta property='og:site_name' content='秋 草 观 “测” 台'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='接口测试'><meta property='article:tag' content='测试工具'><meta property='article:published_time' content='2025-05-04T00:00:00+00:00'><meta property='article:modified_time' content='2025-05-04T00:00:00+00:00'><meta name=twitter:title content="可以抛弃postman啦, API测试工具Bruno实用教程(二)：进阶篇"><meta name=twitter:description content="在前文 【】和 【】中，我们分别对Bruno 这个近来备受关注的接口测试工具的优缺点和基本使用方法进行了介绍，本文我们会继续在上一篇的基础上，介绍 Bruno 和自动化测试相关的进阶用法\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/automnGrass_hu_5e44a092fd905642.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>秋 草 观 “测” 台</a></h1><h2 class=site-description>Testing is not just checking...</h2></div></header><ol class=menu-social><li><a href=https://github.com/chengxiaqiucao target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://space.bilibili.com/472272606 target=_blank title=Bilibili rel=me><!doctype html><svg t="1750732982440" class="icon" viewBox="0 0 1024 1024" p-id="4593" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632 444.330667 256h135.296l138.368-138.325333A42.666667 42.666667.0 01778.368 178.048L700.330667 256H789.333333A149.333333 149.333333.0 01938.666667 405.333333v341.333334A149.333333 149.333333.0 01789.333333 896H234.666667A149.333333 149.333333.0 0185.333333 746.666667V405.333333A149.333333 149.333333.0 01234.666667 256h88.96L245.632 177.962667a42.666667 42.666667.0 0160.373333-60.373334zm483.328 223.701333H234.666667a64 64 0 00-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0057.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0063.701334-57.856L853.333333 746.666667V405.333333a64 64 0 00-64-64zm-448 128A42.666667 42.666667.0 01384 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666666-42.666667zm341.333334.0A42.666667 42.666667.0 01725.333333 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666667-42.666667z" p-id="4594" fill="#8a8a8a"/></svg></a></li><li><a href=https://www.zhihu.com/people/qiucao target=_blank title=zhihu rel=me><!doctype html><svg t="1750733049138" class="icon" viewBox="0 0 1024 1024" p-id="5820" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M570.581333 806.272h61.952L652.928 876.117333 764.074667 806.272h130.986666V230.186667h-324.48V806.272zM636.501333 292.693333h192.64V743.68h-73.898666l-73.813334 46.378667L668.032 743.808l-31.530667-.128V292.736zM515.754667 493.738667H377.429333a2999.466667 2999.466667.0 005.802667-194.56h135.338667S523.776 239.445334 495.872 240.128H261.76c9.216-34.730667 20.821333-70.613333 34.688-107.690667.0.0-63.701333.0-85.333333 57.130667C202.112 213.12 176.128 303.786667 129.877333 396.416c15.573333-1.706667 67.114667-3.114667 97.450667-58.794667 5.589333-15.616 6.656-17.621333 13.568-38.485333h76.373333c0 27.776-3.157333 177.109333-4.437333 194.474667h-138.24c-31.104.0-41.173333 62.549333-41.173333 62.549333h173.482666C295.253333 688.256 232.789333 799.573333 119.466667 887.466667c54.186667 15.488 108.202667-2.432 134.912-26.197334.0.0 60.8-55.338667 94.122666-183.381333L491.264 849.834667s20.906667-71.168-3.285333-105.856c-20.053333-23.637333-74.24-87.552-97.322667-110.72l-38.698667 30.72c11.52-36.992 18.474667-72.96 20.821334-107.690667h163.072s-.213333-62.549333-20.053334-62.549333z" p-id="5821" fill="#8a8a8a"/></svg></a></li><li><a href=mailto:%20danmyw@qq.com target=_blank title=e-mail rel=me><!doctype html><svg t="1750733089669" class="icon" viewBox="0 0 1451 1024" p-id="6983" xmlns:xlink="http://www.w3.org/1999/xlink" width="283.3984375" height="200"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z" fill="#8a8a8a" p-id="6984"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/page/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>检索</span></a></li><li><a href=/page/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li><a href=/page/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/page/releases/><svg class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg>
<span>热门开源</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://chengxiaqiucao.github.io/en/>English</option><option value=https://chengxiaqiucao.github.io/ selected>中文</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#bruno的六层变量作用域>Bruno的六层变量作用域</a><ol><li><a href=#全局变量>全局变量</a></li><li><a href=#collection变量>Collection变量</a></li><li><a href=#环境变量>环境变量</a></li><li><a href=#folder变量>Folder变量</a></li><li><a href=#请求变量>请求变量</a></li><li><a href=#运行时变量>运行时变量</a></li><li><a href=#流程环境变量>流程环境变量</a></li></ol></li><li><a href=#bruno脚本及执行顺序>Bruno脚本及执行顺序</a><ol><li><a href=#1-sandwich-flow-默认>1. Sandwich Flow （默认）</a></li><li><a href=#2-sequential-natural-flow>2. Sequential (Natural) Flow</a></li><li><a href=#执行示例>执行示例</a></li></ol></li><li><a href=#流程依赖处理>流程依赖处理</a></li><li><a href=#runner执行器>Runner执行器</a><ol><li><a href=#bruno命令行-bruno-cli>Bruno命令行 Bruno CLI</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/ style=background-color:#c6fad2;color:#000>测试工具</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/090-bruno%E8%BF%9B%E9%98%B6/>可以抛弃postman啦, API测试工具Bruno实用教程(二)：进阶篇</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 04, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 5 分钟</time></div></footer></div></header><section class=article-content><p>在前文 【】和 【】中，我们分别对<code>Bruno</code> 这个近来备受关注的接口测试工具的优缺点和基本使用方法进行了介绍，本文我们会继续在上一篇的基础上，介绍 <strong>Bruno</strong> 和自动化测试相关的进阶用法</p><h2 id=bruno的六层变量作用域>Bruno的六层变量作用域</h2><p>和 <strong>postman</strong> 类似，<strong>Bruno</strong> 中也同样对接口测试中的变量使用提供了多层设计，可以通过不同层级的作用域区分，为接口测试和自动化提供了更多灵活性和应用场景。</p><p>Bruno中提供了6类不同的变量，其作用范围次序如下：</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250429.png width=954 height=384 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250429_hu_8ec68d7d160bb425.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250429_hu_84c366fc5b3852f8.png 1024w" loading=lazy class=gallery-image data-flex-grow=248 data-flex-basis=596px></p><h3 id=全局变量>全局变量</h3><p>全局变量是作用范围最大的变量类型。设置全局变量是通过 Bruno 的 <code>global Environments</code> 设置，位置如下：</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505.png width=793 height=365 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505_hu_c2ba7aa86d26e494.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505_hu_7bb6ba58895c7433.png 1024w" loading=lazy class=gallery-image data-flex-grow=217 data-flex-basis=521px></p><p>然后比如增加一个全局变量，配置并启用：
<img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-1.png width=1271 height=732 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-1_hu_b0464db4f96920e1.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-1_hu_1d7f1b2a1e370c94.png 1024w" loading=lazy class=gallery-image data-flex-grow=173 data-flex-basis=416px></p><p>这时我们获取Github API中的用户信息，可以获取<code>userid = 1</code> 的用户</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-2.png width=1910 height=787 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-2_hu_d0d136c3cb6c1581.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-2_hu_62e83964fba76922.png 1024w" loading=lazy class=gallery-image data-flex-grow=242 data-flex-basis=582px></p><h3 id=collection变量>Collection变量</h3><p>在设置了全局变量后，再设置 collection 集合变量
<img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-3.png width=1389 height=613 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-3_hu_e44d8c7b1916b798.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-3_hu_99f2d49a198691af.png 1024w" loading=lazy class=gallery-image data-flex-grow=226 data-flex-basis=543px></p><p>然后发送请求，此时生效的就是集合变量</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-4.png width=1896 height=555 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-4_hu_5a3d4cee045cf674.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-4_hu_856871b559d49608.png 1024w" loading=lazy class=gallery-image data-flex-grow=341 data-flex-basis=819px></p><h3 id=环境变量>环境变量</h3><p>下一层是可以设置不同的环境，在如下位置配置：</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-5.png width=1603 height=706 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-5_hu_2c6a8b2bb0e09b94.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-5_hu_c691d1ff40f5c9b1.png 1024w" loading=lazy class=gallery-image data-flex-grow=227 data-flex-basis=544px></p><p>此时生效的是 <code>userid = 3</code></p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-6.png width=1917 height=647 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-6_hu_efc797d954d9dc95.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-6_hu_e55b5a837cb08550.png 1024w" loading=lazy class=gallery-image data-flex-grow=296 data-flex-basis=711px></p><h3 id=folder变量>Folder变量</h3><p>在collection下一层，可以创建目录，这里设置变量， 生效的就是目录变量</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-7.png width=967 height=619 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-7_hu_909d034f40238aad.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-7_hu_3f1f95d0e690a133.png 1024w" loading=lazy class=gallery-image data-flex-grow=156 data-flex-basis=374px></p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-8.png width=1897 height=728 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-8_hu_1d45c2196d2da54e.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-8_hu_197cda31de260b22.png 1024w" loading=lazy class=gallery-image data-flex-grow=260 data-flex-basis=625px></p><h3 id=请求变量>请求变量</h3><p>再下一层，则是具体的请求当中设置的变量</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-9.png width=1913 height=633 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-9_hu_2f6e319a18e77f1d.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-9_hu_4d415befcf26da98.png 1024w" loading=lazy class=gallery-image data-flex-grow=302 data-flex-basis=725px></p><h3 id=运行时变量>运行时变量</h3><p>除了预设变量的情况，Bruno也支持通过脚本，在执行时设置<strong>运行时变量</strong>，使用如下代码设置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>bru</span><span class=p>.</span><span class=nx>setVar</span><span class=p>(</span><span class=s2>&#34;userid&#34;</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>在执行请求后，查看当前runtime变量，还可以通过工具栏中的对应按钮进入显示界面查看。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-10.png width=1917 height=553 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-10_hu_ab823dece5d2b358.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-10_hu_d3c59748e0c37f.png 1024w" loading=lazy class=gallery-image data-flex-grow=346 data-flex-basis=831px></p><p>通过以上实例，可以看到，Bruno的多层变量体系及其作用范围，同样的变量名，生效优先次序依次为：</p><p><strong>运行时变量 -> 请求变量 -> 目录变量 -> 环境变量 -> 集合变量 -> 全局变量</strong></p><h3 id=流程环境变量>流程环境变量</h3><p>除了上面这些多层变量设计外，在我们处理接口时，像token、API Key或一些账号密码等比较敏感的数据变量，可能并不希望在接口及相关配置文件( *.bru )中体现。针对这类变量，Bruno 也提供了一个针对性的处理方式，就是通过 <code>.env</code> 文件来存储。<code>.env</code> 文件需放置在collection的根目录下，变量定义采用key-value 形式，如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>userid = 7
</span></span></code></pre></td></tr></table></div></div><p>这时，我们在配置变量时就可以通过<code>{{process.env.userid}}</code> 来实现引用，避免相关敏感数据，直接出现在接口定义文件中</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-11.png width=1624 height=674 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-11_hu_eec7d6decd9cec18.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-11_hu_e4933bcc0d510a0.png 1024w" loading=lazy class=gallery-image data-flex-grow=240 data-flex-basis=578px></p><h2 id=bruno脚本及执行顺序>Bruno脚本及执行顺序</h2><p>Bruno的脚本功能，使用的是标准JavaScript语法。可以在Collection、Folder、Request三个不同层级上定义请求前（Pre）和请求后（Post）要执行的脚本。并且Bruno提供了两种脚本执行顺序模型（主要区别是post脚本的执行顺序）</p><h3 id=1-sandwich-flow-默认>1. Sandwich Flow （默认）</h3><p>这种模式下，不同层级脚本的执行顺序如下</p><ul><li><strong>Collection Pre Script</strong><ul><li><strong>Folder Pre Script</strong><ul><li><strong>Request Pre Script</strong></li></ul></li></ul></li><li><strong>Request Post Script</strong><ul><li><strong>Folder Post Script</strong><ul><li><strong>Collection Post Script</strong></li></ul></li></ul></li></ul><p>和各类单元测试框架的分层执行顺序类似。</p><h3 id=2-sequential-natural-flow>2. Sequential (Natural) Flow</h3><p>这种执行顺序，和Postman的脚本执行顺序类似，完全按层级顺序来执行。</p><ul><li><strong>Collection Pre Script</strong><ul><li><strong>Folder Pre Script</strong><ul><li><strong>Request Pre Script</strong></li></ul></li></ul></li><li><strong>Collection Post Script</strong><ul><li><strong>Folder Post Script</strong><ul><li><strong>Request Post Script</strong></li></ul></li></ul></li></ul><p>要采用这种顺序，需要在Bruno的配置文件 <code>bruno.json</code> 中配置 <code>flow</code> 参数，形如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;filesystemAccess&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;allow&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;flow&#34;</span><span class=p>:</span> <span class=s2>&#34;sequential&#34;</span> <span class=c1>// Or &#34;sandwich&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=执行示例>执行示例</h3><p>在各个层级的脚本中分别添加对应的脚本日志，打开Bruno集成的Dev Tool控制台，可看到对应执行顺序的不同。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-12.png width=1907 height=959 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-12_hu_1a46deb8aec95501.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-12_hu_b0096c7bac7c1381.png 1024w" loading=lazy class=gallery-image data-flex-grow=198 data-flex-basis=477px></p><p>修改 <code>bruno.json</code>， 配置flow模式为 <code>sequential</code>，可以看到post部分的输出顺序发生了变化。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-13.png width=1900 height=959 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-13_hu_770e6918705a367f.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250505-13_hu_c881d4b8b6e3241d.png 1024w" loading=lazy class=gallery-image data-flex-grow=198 data-flex-basis=475px></p><h2 id=流程依赖处理>流程依赖处理</h2><p>在我们实际的接口测试时，一个经常遇到的场景，就是后续的请求，会需要依赖之前请求的返回数据，比如最常见的动态token获取等场景。</p><p>而利用Bruno的变量和脚本，我们可以通过脚本实现这种接口的关联操作。</p><p>在Bruno的官方文档中，他内置的bru对象，提供了 <code>setNextRequest</code>， <code>runRequest</code> 这样的方法，使我们可以根据自己的需要，确定在执行某个接口请求时，指定下一条需要执行的请求（不再按默认顺序执行），或者也可以直接在当前请求的脚本中，运行其他接口请求。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-2.png width=1799 height=859 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-2_hu_dfaa9fd6e928ba6c.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-2_hu_7530ca08e3e55a12.png 1024w" loading=lazy class=gallery-image data-flex-grow=209 data-flex-basis=502px></p><p>通过这种方式，我们就可以通过设置变量，并将变量进行接口间的传递，以此完成流程依赖场景的实现。</p><p>比如这里我们获取github用户下的repo清单，这个接口。 这里的 <code>{{username}}</code> 变量，我们希望通过指定 <code>userid</code> 来获取。也就是先执行前面的 <code>getUserInfo</code> 这个接口，根据 <code>userid</code> 来获取 <code>username</code>。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-3.png width=1133 height=468 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-3_hu_3c1e92897aea7bb5.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-3_hu_1ef80bb2a9103da9.png 1024w" loading=lazy class=gallery-image data-flex-grow=242 data-flex-basis=581px></p><p>这里我们定义getUserRepos，使用变量<code>{{username}}</code>， 但此时该变量未定义，所以显示为红色</p><p>然后在 <code>getUserInfo</code> 这个接口中，我们定义脚本，提取当前响应的username，并进行变量赋值。然后直接调用 <code>getUserRepos</code> 接口（注意这里调用的接口路径，应该以collection根路径进行定义）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>bru</span><span class=p>.</span><span class=nx>setVar</span><span class=p>(</span><span class=s2>&#34;username&#34;</span><span class=p>,</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>login</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>bru</span><span class=p>.</span><span class=nx>runRequest</span><span class=p>(</span><span class=s2>&#34;variables/getUserRepos&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>执行<code>getUserInfo</code>， 可以看到，执行成功，脚本中执行的 <code>getUserRepos</code> 接口也成功得到了 <code>200OK</code> 的响应状态</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-4.png width=1915 height=959 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-4_hu_9a6d4480f9e77d22.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-4_hu_523668b12748d1de.png 1024w" loading=lazy class=gallery-image data-flex-grow=199 data-flex-basis=479px></p><h2 id=runner执行器>Runner执行器</h2><p>除了在脚本中执行指定接口， Bruno其实也提供了一个Runner的执行器，从工具栏打开执行器，也可以批量地依次运行Collection中的所有接口</p><p>比如上例，我们如果只是在 <code>getUserInfo</code> 中获取并定义变量 username, 而不执行。 只要<code>getUserRepos</code>在 <code>getUserInfo</code> 之后执行，也同样可以执行成功。</p><p>Runner运行效果如下：</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507.png width=786 height=739 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507_hu_e9749e6ff9e8c3d9.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507_hu_75c21443013e260a.png 1024w" loading=lazy class=gallery-image data-flex-grow=106 data-flex-basis=255px></p><p>但这里Bruno默认的功能，是运行collection中的所有请求，且调整顺序的功能，虽然有提供，但只包含在付费的高级版中，包括基于csv或json的数据驱动功能，免费版本中也不包含。稍显鸡肋。</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-1.png width=1908 height=602 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-1_hu_53841b760253dcdf.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-1_hu_93ca7e915c00a747.png 1024w" loading=lazy class=gallery-image data-flex-grow=316 data-flex-basis=760px></p><h3 id=bruno命令行-bruno-cli>Bruno命令行 Bruno CLI</h3><p>上面 <code>Runner执行器</code> 的功能因为受限，在我们要进行接口自动化时，比较鸡肋，基本无法使用。但Bruno这里的高级版本功能，其实只是针对界面上触发进行了限制。</p><p>我们要执行自动化，也可以利用它提供的命令行功能来实现。</p><p>这里的CLI程序，需要单独安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>npm install -g @usebruno/cli
</span></span></code></pre></td></tr></table></div></div><p>安装后，能正确显示版本号表示安装成功， 如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>C:\qiucao&gt;bru --version
</span></span><span class=line><span class=cl>2.1.0
</span></span></code></pre></td></tr></table></div></div><p>通过命令行执行，我们就可以根据自己的需要，比如执行指定目录下的接口。</p><p>这里携带的两个参数 <code>--env</code> 指定需要使用的环境， <code>--reporter-html</code> 会在完成执行后生成一个html格式的测试报告。（详细的参数，可参考文档 <a class=link href=https://docs.usebruno.com/bru-cli/commandOptions target=_blank rel=noopener>https://docs.usebruno.com/bru-cli/commandOptions</a>）</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-5.png width=1073 height=778 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-5_hu_892e0de1fbf09c4.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-5_hu_f986bea380a76775.png 1024w" loading=lazy class=gallery-image data-flex-grow=137 data-flex-basis=331px></p><p>生成的测试报告：</p><p><img src=/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-6.png width=1920 height=904 srcset="/post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-6_hu_bb7cb51a71c4e95d.png 480w, /post/090-bruno%E8%BF%9B%E9%98%B6/snap_20250507-6_hu_4ca67f049a940f86.png 1024w" loading=lazy class=gallery-image data-flex-grow=212 data-flex-basis=509px></p><hr><p>以上就是关于Bruno中使用脚本和自动化执行相关功能的进阶说明。欢迎继续关注后续文章。</p><p>回复<code>大纲</code> 可查看秋草测试技能全栈提升课详细目录。回复 <code>进群</code>可进入测试交流群和小伙伴们分享测试技术、交换资讯。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/>接口测试</a>
<a href=/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/>测试工具</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/088-bruno%E5%9F%BA%E7%A1%80/><div class=article-details><h2 class=article-title>Postman最佳平替, API测试工具Bruno实用教程(一)：基础篇</h2></div></a></article><article class=has-image><a href=/post/089-bruno%E4%BB%8B%E7%BB%8D/><div class=article-image><img src=/post/089-bruno%E4%BB%8B%E7%BB%8D/snap_20250420-2.08587706a670667ac3ab77a32fec6d23_hu_4b8a4bf9a236d971.png width=250 height=150 loading=lazy alt="Featured image of post github星标超3万！Postman最强平替Bruno你用了吗？" data-hash="md5-CFh3BqZwZnrDq3ejL+xtIw=="></div><div class=article-details><h2 class=article-title>github星标超3万！Postman最强平替Bruno你用了吗？</h2></div></a></article><article class=has-image><a href=/post/120-autotestdata/><div class=article-image><img src=/post/120-autotestdata/title.665ed01cdeaf3ce986fb754c231a1e3e_hu_7de74c14e491bf75.png width=250 height=150 loading=lazy alt="Featured image of post 推荐一个用于页面探索测试的数据辅助工具" data-hash="md5-Zl7QHN6vPOmG+3VMIxoePg=="></div><div class=article-details><h2 class=article-title>推荐一个用于页面探索测试的数据辅助工具</h2></div></a></article><article class=has-image><a href=/post/118-pom_replacement/><div class=article-image><img src=/post/118-pom_replacement/Pasted-20250806.f76c8d5a1901a96f974bf59653a68a57_hu_14ccbf1f5b41b9c6.png width=250 height=150 loading=lazy alt="Featured image of post UI自动化，POM之外的另一模式" data-hash="md5-92yNWhkBqW+XS/WWU6aKVw=="></div><div class=article-details><h2 class=article-title>UI自动化，POM之外的另一模式</h2></div></a></article><article class=has-image><a href=/post/117-loguru/><div class=article-image><img src=/post/117-loguru/Pasted-20250801-2.8ee8f59ebe8d6f3ddb34358b188b5887_hu_bf4eba15896e332.png width=250 height=150 loading=lazy alt="Featured image of post python日志的新姿势，Loguru库的应用" data-hash="md5-juj1nr6Nbz3bNDWLGItYhw=="></div><div class=article-details><h2 class=article-title>python日志的新姿势，Loguru库的应用</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 |by 城下秋草（公众号： 秋草说测试）</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>